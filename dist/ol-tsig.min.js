!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("ol/events/condition"),require("ol/interaction/Select"),require("ol/layer/Vector"),require("ol/layer/Group"),require("ol/format/GeoJSON"),require("ol/style"),require("ol/format"),require("ol/source"),require("ol/layer"),require("ol/util"),require("ol/Map"),require("ol/View"),require("ol/proj")):"function"==typeof define&&define.amd?define(["ol/events/condition","ol/interaction/Select","ol/layer/Vector","ol/layer/Group","ol/format/GeoJSON","ol/style","ol/format","ol/source","ol/layer","ol/util","ol/Map","ol/View","ol/proj"],e):"object"==typeof exports?exports["ol-tsig"]=e(require("ol/events/condition"),require("ol/interaction/Select"),require("ol/layer/Vector"),require("ol/layer/Group"),require("ol/format/GeoJSON"),require("ol/style"),require("ol/format"),require("ol/source"),require("ol/layer"),require("ol/util"),require("ol/Map"),require("ol/View"),require("ol/proj")):t["ol-tsig"]=e(t.ol.events.condition,t.ol.interaction.Select,t.ol.layer.Vector,t.ol.layer.Group,t.ol.format.GeoJSON,t.ol.style,t.ol.format,t.ol.source,t.ol.layer,t.ol.util,t.ol.Map,t.ol.View,t.ol.proj)}(window,(function(t,e,i,n,r,o,s,a,h,l,c,u,f){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=14)}([function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e){t.exports=i},function(t,e){t.exports=n},function(t,e){t.exports=r},function(t,e,i){t.exports=function(){"use strict";function t(t,n,r,o,s){!function t(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,h=n-r+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(h-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-h*c/a+u)),Math.min(o,Math.floor(n+(a-h)*c/a+u)),s)}var f=i[n],p=r,d=o;for(e(i,r,n),s(i[o],f)>0&&e(i,r,o);p<d;){for(e(i,p,d),p++,d--;s(i[p],f)<0;)p++;for(;s(i[d],f)>0;)d--}0===s(i[r],f)?e(i,r,d):e(i,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}(t,n,r||0,o||t.length-1,s||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,r){r||(r=d(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=e;o<i;o++){var s=t.children[o];a(r,t.leaf?n(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(e,i,n,r,o){for(var s=[i,n];s.length;)if(!((n=s.pop())-(i=s.pop())<=r)){var a=i+Math.ceil((n-i)/r/2)*r;t(e,a,i,n,o),s.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!p(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;p(t,a)&&(e.leaf?i.push(s):f(t,a)?this._all(s,i):r.push(s))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],o=e.leaf?this.toBBox(r):r;if(p(t,o)){if(e.leaf||f(t,o))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,o,s=this.data,a=this.toBBox(t),h=[],l=[];s||h.length;){if(s||(s=h.pop(),n=h[h.length-1],i=l.pop(),o=!0),s.leaf){var c=r(t,s.children,e);if(-1!==c)return s.children.splice(c,1),h.push(s),this._condense(h),this}o||s.leaf||!f(s,a)?n?(i++,s=n.children[i],o=!1):s=null:(h.push(s),l.push(i),i=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,s=i-e+1,a=this._maxEntries;if(s<=a)return o(r=d(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(r=d([])).leaf=!1,r.height=n;var h=Math.ceil(s/a),l=h*Math.ceil(Math.sqrt(a));_(t,e,i,l,this.compareMinX);for(var c=e;c<=i;c+=l){var u=Math.min(c+l-1,i);_(t,c,u,h,this.compareMinY);for(var f=c;f<=u;f+=h){var p=Math.min(f+h-1,u);r.children.push(this._build(t,f,p,n-1))}}return o(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var h=e.children[a],l=c(h),u=(f=t,p=h,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l);u<o?(o=u,r=l<r?l:r,s=h):u===o&&l<r&&(r=l,s=h)}e=s||e.children[0]}var f,p;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],o=this._chooseSubtree(n,this.data,e,r);for(o.children.push(t),a(o,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var s=this._chooseSplitIndex(i,r,n),a=d(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,o(i,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,o,a,h,l,u,f=1/0,p=1/0,d=e;d<=i-e;d++){var _=s(t,0,d,this.toBBox),g=s(t,d,i,this.toBBox),y=(r=_,o=g,a=Math.max(r.minX,o.minX),h=Math.max(r.minY,o.minY),l=Math.min(r.maxX,o.maxX),u=Math.min(r.maxY,o.maxY),Math.max(0,l-a)*Math.max(0,u-h)),v=c(_)+c(g);y<f?(f=y,n=d,p=v<p?v:p):y===f&&v<p&&(p=v,n=d)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:h,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,o=s(t,0,e,r),h=s(t,i-e,i,r),l=u(o)+u(h),c=e;c<i-e;c++){var f=t.children[c];a(o,t.leaf?r(f):f),l+=u(o)}for(var p=i-e-1;p>=e;p--){var d=t.children[p];a(h,t.leaf?r(d):d),l+=u(h)}return l},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}()},function(t,e){t.exports=o},function(t,e){t.exports=s},function(t,e){t.exports=a},function(t,e){t.exports=h},function(t,e){t.exports=l},function(t,e){t.exports=c},function(t,e){t.exports=u},function(t,e){t.exports=f},function(t,e,i){t.exports=i(15)},function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"OlTsError",(function(){})),i.d(n,"olTsUtilsJSON2Style",(function(){return C})),i.d(n,"olTsUtilsJSON2Source",(function(){return k})),i.d(n,"olTsUtilsJSON2Layer",(function(){return L}));var r={};i.r(r),i.d(r,"OlTsLayerGroup",(function(){return W})),i.d(r,"OlTsLayerScale",(function(){return K})),i.d(r,"OlTsLayerVector",(function(){return ot})),i.d(r,"OlTsLayerORS",(function(){return ut})),i.d(r,"OlTsLayerGroupORS",(function(){return vt}));var o={};i.r(o),i.d(o,"OlTsEditionBar",(function(){return jh}));var s={};i.r(s),i.d(s,"OlTsMap",(function(){return Jh}));var a=i(3),h=i.n(a);function l(t){return("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){var e="function"==typeof Map?new Map:void 0;return function(t){if(null===t||(t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return p(t,arguments,_(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),d(n,t)}(t)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t,e,i){return(f()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&d(r,i.prototype),r}).apply(null,arguments)}function d(t,e){return(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t){return(Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g={err_100:'Escalas mal definidas en "LayerScale".',desconocido:"Error no Definido."},y=(Error,i(6));function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var m={fill:"Fill",image:"Image",stroke:"Stroke",text:"Text"},w={image:{type:"Circle",radius:6,fill:{color:"rgba(250,250,250,0.1)"},stroke:{color:"#F00",width:2}},stroke:{color:"#F00",width:2},fill:{color:"rgba(250,250,250,0.1)"},zIndex:1},x={image:{type:"Circle",radius:6,fill:{color:"rgba(0,153,255,1)"},stroke:{color:"#FFF",width:1.25}},stroke:{color:"#09F",width:3},fill:{color:"rgba(250,250,250,0.1)"},zIndex:1};function S(t){if(Array.isArray(t)){for(var e=[],i=0,n=t.length;i<n;i++)e.push(S(t[i]));return e}return new y.Style(function t(e){for(var i={},n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];"object"===v(e[o])?(i[o]=new y[e[o].type||m[o]](t(e[o])),e[o].type&&(i[o].type=e[o].type)):i[o]=e[o]}return i}(t))}var C={json2Style:S,styleSelect:function(t){return S(t||w)},styleEdit:function(t){return S(t||x)}},b=i(7),O=i(8);function E(t){return t.source&&(t.source=E(t.source)),t.format&&(t.format=new b[t.format.type](t.format)),new O[t.type](t)}var k={json2source:E,json2sources:function(t){if(!t.sourceSelect)return t.sourceSelect=t.source[0].name,E(t.sources[0]);for(var e=0,i=t.sources.length;e<i;++e)if(t.sourceSelect===t.sources[e].name)return E(t.sources[e])}},P=i(9);function I(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function T(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function D(){return function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(Object(i),!0).forEach((function(e){T(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},P,{},r)}function M(t){var e=JSON.parse(JSON.stringify(t));return e.sources?e.source=k.json2sources(e):e.source&&(e.source=k.json2source(e.source)),e.style&&(e.style=C.json2Style(e.style)),new(D()[e.type])(e)}var L={json2Layer:M,json2Layers:function(t){for(var e=[],i=0,n=t.length;i<n;++i)t[i].type&&e.push(M(t[i]));return e}};function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function j(t,e){return!e||"object"!==F(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var W=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=t||{},n=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?R(Object(i),!0).forEach((function(e){A(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):R(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},i);return delete n.layers,n.layers=(new(void 0)).json2Layers(i.layers),j(this,G(e).call(this,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}(e,t),e}(h.a);function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Y(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function q(t,e){return!e||"object"!==X(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function V(t,e){return(V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var K=function(t){function e(t){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t||{},r=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?B(Object(i),!0).forEach((function(e){Y(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):B(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},n);if(delete r.layers,r.layers=L.json2Layers(n.layers),!function(t){for(var e=[],i=0;i<t.length;i+=1){t[i].set("visible",!0,!0);for(var n=(o=t[i],s=void 0,s=o.getMaxZoom(),[o.getMinZoom(),s===1/0?100:s]),r=0;r<i;r+=1){if(n[0]>=e[r][0]&&n[0]<e[r][1])return!1;if(n[1]>e[r][0]&&n[1]<=e[r][1])return!1}e.push(n)}var o,s;return!0}(r.layers))throw new(void 0)(100);return i=q(this,z(e).call(this,r)),q(i)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e)}(e,t),e}(h.a),U=i(2),H=i.n(U),Z=i(4),J=i.n(Z);function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function tt(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function et(t){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nt=function(t){function e(t){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t||{};if(n.source||(n.source=k.json2source({type:"Vector"})),(i=tt(this,et(e).call(this,n))).selectable=n.selectable||!1,i.editable=n.editable||!1,i.geometryType=n.geometryType||void 0,n.labels&&n.style){var r=n.labels,o=i.getStyle();r.fields?i.setStyle((function(t){var e=o.clone(),i=e.getText();if(i&&r.visible){for(var n=r.template,s=0;s<r.fields.length;s++)n=rt[r.fields[s][0]](n,t,r.fields[s]);i.setText(n)}return e})):i.setStyle((function(t){var e=o.clone(),i=e.getText();return i&&i.setText(r.visible?t.get(r.field):void 0),e}))}return i}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(e,t),i=e,(n=[{key:"save",value:function(t){for(var e=[],i=[],n=[],r=0,o=Object.keys(t);r<o.length;r++){var s=o[r];console.log(s),"addfeature"===t[s].type?e.push(t[s].feature):"changefeature"===t[s].type?i.push(t[s].feature):"removefeature"===t[s].type&&n.push(t[s].feature.getId())}var a={};e.length&&(a.addfeatures=new J.a({}).writeFeaturesObject(e)),i.length&&(a.changefeature=new J.a({}).writeFeaturesObject(i)),n.length&&(a.removefeature=n),console.log("(LayerVector) SALVANDO capa."),console.log("edited: ",a)}}])&&Q(i.prototype,n),r&&Q(i,r),e}(H.a),rt={count:function(t,e,i){return t.replace(i[0],e.get("features").length)},sum:function(t,e,i){for(var n=e.get("features"),r=0,o=n.length-1;o>=0;--o)r+=1*(n[o].get(i[1])||0);return i[2]&&(r=r.toFixed(i[2])),t.replace(i[1],r)},media:function(t,e,i){for(var n=0,r=0,o=e.get("features"),s=o.length-1;s>=0;--s){var a=o[s].get(i[1]);void 0!==a&&(n+=1*a,r+=1)}return r?(n/=r,i[2]&&(n=n.toFixed(i[2]))):n="-",t.replace(i[1],n)}},ot=nt;function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ht(t,e){return!e||"object"!==st(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lt(t){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=function(t){function e(t){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t||{};return(i=ht(this,lt(e).call(this,n))).apiKey=n.apiKey,i.getSource().on("addfeature",(function(t){t.feature.ruta||i.addRoute(t.feature)})),i}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(e,t),i=e,(n=[{key:"addRoute",value:function(t){var e=this,i=t,n=new XMLHttpRequest;n.open("POST","https://api.openrouteservice.org/v2/directions/driving-car/geojson"),n.setRequestHeader("Accept","application/json, application/geo+json, application/gpx+xml, img/png; charset=utf-8"),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Authorization",this.apiKey),n.onreadystatechange=function(){if(4===this.readyState)if(this.status>=200&&this.status<400){var t=e.getSource();t.removeFeature(i);for(var n=new J.a({featureProjection:"EPSG:3857"}).readFeatures(JSON.parse(this.response)),r=0;r<n.length;r++)n[r].ruta=!0;t.addFeatures(n)}else e.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,jqXHR:this})};var r={coordinates:i.getGeometry().clone().transform("EPSG:3857","EPSG:4326").getCoordinates()};n.send(JSON.stringify(r))}}])&&at(i.prototype,n),r&&at(i,r),e}(nt);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function dt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _t(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=t||{},n=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(i),!0).forEach((function(e){dt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):pt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},i);return delete n.layers,n.layers=(void 0).json2Layers(i.layers),_t(this,gt(e).call(this,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}(e,t),e}(h.a);window.ol&&!ol.ext&&(ol.ext={});var mt=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t};window.ol&&(ol.inherits||(ol.inherits=mt)),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.Element&&!Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});var wt=mt;function xt(t,e){return t>e?1:t<e?-1:0}function St(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function Ct(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}function bt(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Ot(){return!0}function Et(){return!1}function kt(){}var Pt="postrender";function It(){return function(){throw new Error("Unimplemented abstract method.")}()}var Tt=0;function Dt(t){return t.ol_uid||(t.ol_uid=String(++Tt))}var Mt="propertychange",Lt="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1,r=arguments.length;n<r;++n){var o=arguments[n];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])}return i};function Ft(t){for(var e in t)delete t[e]}var Rt="function"==typeof Object.values?Object.values:function(t){var e=[];for(var i in t)e.push(t[i]);return e};function At(t){var e;for(e in t)return!1;return!e}function jt(t,e,i,n,r){if(n&&n!==t&&(i=i.bind(n)),r){var o=i;i=function(){t.removeEventListener(e,i),o.apply(this,arguments)}}var s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function Gt(t,e,i,n){return jt(t,e,i,n,!0)}function Nt(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Ft(t))}var Wt=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();var Xt,Bt=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),Yt=(Xt=function(t,e){return(Xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}Xt(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),qt=function(t){function e(e){var i=t.call(this)||this;return i.eventTarget_=e,i.pendingRemovals_={},i.dispatching_={},i.listeners_={},i}return Yt(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var i=this.listeners_[t];i||(i=[],this.listeners_[t]=i),-1===i.indexOf(e)&&i.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Bt(t):t,i=e.type;e.target||(e.target=this.eventTarget_||this);var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var o=0,s=r.length;o<s;++o)if(!1===r[o].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,kt);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){Ft(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);-1!==n&&(t in this.pendingRemovals_?(i[n]=kt,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},e}(Wt),zt="change",Vt="error",Kt="clear",Ut="contextmenu",Ht="dblclick",Zt="load",Jt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function $t(t){if(Array.isArray(t))for(var e=0,i=t.length;e<i;++e)Nt(t[e]);else Nt(t)}var Qt=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return Jt(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(zt)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=jt(this,t[r],e);return n}return jt(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=Gt(this,t[r],e);return n}return Gt(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)},e}(qt),te=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ee=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.key=i,r.oldValue=n,r}return te(e,t),e}(Bt),ie=function(t){function e(e){var i=t.call(this)||this;return Dt(i),i.values_={},void 0!==e&&i.setProperties(e),i}return te(e,t),e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return Lt({},this.values_)},e.prototype.notify=function(t,e){var i;i=re(t),this.dispatchEvent(new ee(i,t,e)),i=Mt,this.dispatchEvent(new ee(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(Qt),ne={};function re(t){return ne.hasOwnProperty(t)?ne[t]:ne[t]="change:"+t}var oe=ie;function se(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function ae(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var he=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),le=function(t){function e(e){var i=t.call(this)||this;return i.element=e.element?e.element:null,i.target_=null,i.map_=null,i.listenerKeys=[],i.render=e.render?e.render:kt,e.target&&i.setTarget(e.target),i}return he(e,t),e.prototype.disposeInternal=function(){ae(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&ae(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)Nt(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==kt&&this.listenerKeys.push(jt(t,Pt,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(oe),ce=function(t){t||(t={});var e=document.createElement("div");if(e.classList.add("ol-unselectable","ol-control","ol-bar"),t.className){var i=t.className.split(" ").filter((function(t){return t.length>0}));e.classList.add.apply(e.classList,i)}if(t.group&&e.classList.add("ol-group"),le.call(this,{element:e,target:t.target}),this.set("toggleOne",t.toggleOne),this.set("autoDeactivate",t.autoDeactivate),this.controls_=[],t.controls instanceof Array)for(var n=0;n<t.controls.length;n++)this.addControl(t.controls[n])};wt(ce,le),ce.prototype.setVisible=function(t){this.element.style.display=t?"":"none"},ce.prototype.getVisible=function(){return"none"!=this.element.style.display},ce.prototype.setMap=function(t){le.prototype.setMap.call(this,t);for(var e=0;e<this.controls_.length;e++){this.controls_[e].setMap(t)}},ce.prototype.getControls=function(){return this.controls_},ce.prototype.setPosition=function(t){this.element.classList.remove("ol-left","ol-top","ol-bottom","ol-right"),t=t.split("-");for(var e=0;e<t.length;e++)switch(t[e]){case"top":case"left":case"bottom":case"right":this.element.classList.add("ol-"+t[e])}},ce.prototype.addControl=function(t){this.controls_.push(t),t.setTarget(this.element),this.getMap()&&this.getMap().addControl(t),t.on("change:active",function(e){this.onActivateControl_(e,t)}.bind(this)),t.getActive&&this.onActivateControl_({target:t,active:t.getActive()},t)},ce.prototype.deactivateControls=function(t){for(var e=0;e<this.controls_.length;e++)this.controls_[e]!==t&&this.controls_[e].setActive&&this.controls_[e].setActive(!1)},ce.prototype.getActiveControls=function(){for(var t,e=[],i=0;t=this.controls_[i];i++)t.getActive&&t.getActive()&&e.push(t);return e},ce.prototype.setActive=function(t){if(!t&&this.get("autoDeactivate")&&this.deactivateControls(),t)for(var e,i=this.getControls(),n=0;e=i[n];n++)e.get("autoActivate")&&e.setActive(!0)},ce.prototype.onActivateControl_=function(t,e){if(this.get("toggleOne"))if(t.active){var i;for(i=0;i<this.controls_.length&&this.controls_[i]!==e;i++);if(i==this.controls_.length)return;this.deactivateControls(this.controls_[i])}else if(!this.getActiveControls().length)for(var n,r=0;n=this.controls_[r];r++)if(n.get("autoActivate")){n.setActive(!0);break}},ce.prototype.getControlsByName=function(t){return this.getControls().filter((function(e){return e.get("name")===t}))};var ue=ce,fe=i(0),pe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),de=function(t){function e(e){var i=this,n="Assertion failed. See https://openlayers.org/en/"+("v"+"6.1.1".split("-")[0])+"/doc/errors/#"+e+" for details.";return(i=t.call(this,n)||this).code=e,i.name="AssertionError",i.message=n,i}return pe(e,t),e}(Error);function _e(t,e){if(!t)throw new de(e)}var ge=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var ye=function(t){function e(e){var i=t.call(this)||this;if(i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addEventListener(re(i.geometryName_),i.handleGeometryChanged_),e)if("function"==typeof e.getSimplifiedGeometry){var n=e;i.setGeometry(n)}else{var r=e;i.setProperties(r)}return i}return ge(e,t),e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Nt(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=jt(t,zt,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(_e("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeEventListener(re(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener(re(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(oe),ve=Ht,me="pointerdrag",we="pointermove",xe="pointerdown",Se="pointerup",Ce=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),be=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.map=i,r.frameState=void 0!==n?n:null,r}return Ce(e,t),e}(Bt),Oe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ee=function(t){function e(e,i,n,r,o){var s=t.call(this,e,i,o)||this;return s.originalEvent=n,s.pixel_=null,s.coordinate_=null,s.dragging=void 0!==r&&r,s}return Oe(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(be),ke=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pe=function(t){function e(e,i,n,r,o){var s=t.call(this,e,i,n,r,o)||this;return s.pointerEvent=n,s}return ke(e,t),e}(Ee);function Ie(t,e,i){return Math.min(Math.max(t,e),i)}var Te="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function De(t,e,i,n,r,o){var s=r-i,a=o-n;if(0!==s||0!==a){var h=((t-i)*s+(e-n)*a)/(s*s+a*a);h>1?(i=r,n=o):h>0&&(i+=s*h,n+=a*h)}return Me(t,e,i,n)}function Me(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}function Le(t,e){var i=t%e;return i*e<0?i+e:i}function Fe(t,e,i){return t+i*(e-t)}function Re(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}var Ae="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",je=(Ae.indexOf("firefox"),-1!==Ae.indexOf("safari")&&Ae.indexOf("chrom"),-1!==Ae.indexOf("webkit")&&Ae.indexOf("edge"),Ae.indexOf("macintosh"),window.devicePixelRatio,"undefined"!=typeof Image&&Image.prototype.decode),Ge=Ot,Ne=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},We=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Xe=0,Be=1,Ye=2,qe=4,ze=8,Ve=16;function Ke(t){for(var e=Qe(),i=0,n=t.length;i<n;++i)oi(e,t[i]);return e}function Ue(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function He(t,e,i){var n,r;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*r}function Ze(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Je(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function $e(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=e[0],a=e[1],h=Xe;return s<i?h|=Ve:s>r&&(h|=qe),a<n?h|=ze:a>o&&(h|=Ye),h===Xe&&(h=Be),h}function Qe(){return[1/0,1/0,-1/0,-1/0]}function ti(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function ei(t){return ti(1/0,1/0,-1/0,-1/0,t)}function ii(t,e,i,n,r){return si(ei(r),t,e,i,n)}function ni(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function ri(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function oi(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function si(t,e,i,n,r){for(;i<n;i+=r)ai(t,e[i],e[i+1]);return t}function ai(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function hi(t,e){var i;return(i=e(li(t)))||(i=e(ci(t)))||(i=e(di(t)))?i:(i=e(pi(t)))||!1}function li(t){return[t[0],t[1]]}function ci(t){return[t[2],t[1]]}function ui(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function fi(t){return t[3]-t[1]}function pi(t){return[t[0],t[3]]}function di(t){return[t[2],t[3]]}function _i(t){return t[2]-t[0]}function gi(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function yi(t,e,i){var n=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(n,n,2),function(t,e,i){return ti(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}([n[0],n[2],n[4],n[6]],[n[1],n[3],n[5],n[7]],i)}var vi="Point",mi="LineString",wi="LinearRing",xi="Polygon",Si="MultiPoint",Ci="MultiLineString",bi="MultiPolygon",Oi="GeometryCollection",Ei="Circle";function ki(t,e,i,n,r,o){for(var s=o||[],a=0,h=e;h<i;h+=n){var l=t[h],c=t[h+1];s[a++]=r[0]*l+r[2]*c+r[4],s[a++]=r[1]*l+r[3]*c+r[5]}return o&&s.length!=a&&(s.length=a),s}function Pi(t,e,i,n,r,o,s){for(var a=s||[],h=Math.cos(r),l=Math.sin(r),c=o[0],u=o[1],f=0,p=e;p<i;p+=n){var d=t[p]-c,_=t[p+1]-u;a[f++]=c+d*h-_*l,a[f++]=u+d*l+_*h;for(var g=p+2;g<p+n;++g)a[f++]=t[g]}return s&&a.length!=f&&(a.length=f),a}function Ii(t,e,i,n,r,o,s){for(var a=s||[],h=0,l=e;l<i;l+=n){a[h++]=t[l]+r,a[h++]=t[l+1]+o;for(var c=l+2;c<l+n;++c)a[h++]=t[c]}return s&&a.length!=h&&(a.length=h),a}
/**
 * @license
 * Latitude/longitude spherical geodesy formulae taken from
 * http://www.movable-type.co.uk/scripts/latlong.html
 * Licensed under CC-BY-3.0.
 */var Ti={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Di={};Di[Ti.DEGREES]=2*Math.PI*6370997/360,Di[Ti.FEET]=.3048,Di[Ti.METERS]=1,Di[Ti.USFEET]=1200/3937;var Mi=Ti,Li=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Di[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}(),Fi=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ri=6378137*Math.PI,Ai=[-Ri,-Ri,Ri,Ri],ji=[-180,-85,180,85],Gi=function(t){function e(e){return t.call(this,{code:e,units:Mi.METERS,extent:Ai,global:!0,worldExtent:ji,getPointResolution:function(t,e){return t/Te(e[1]/6378137)}})||this}return Fi(e,t),e}(Li),Ni=[new Gi("EPSG:3857"),new Gi("EPSG:102100"),new Gi("EPSG:102113"),new Gi("EPSG:900913"),new Gi("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Gi("urn:ogc:def:crs:EPSG::3857"),new Gi("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Wi(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=Ri,a=0;a<n;a+=r){o[a]=s*t[a]/180;var h=6378137*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));h>s?h=s:h<-s&&(h=-s),o[a+1]=h}return o}function Xi(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/Ri,o[s+1]=360*Math.atan(Math.exp(t[s+1]/6378137))/Math.PI-90;return o}var Bi=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Yi=[-180,-90,180,90],qi=6378137*Math.PI/180,zi=function(t){function e(e,i){return t.call(this,{code:e,units:Mi.DEGREES,extent:Yi,axisOrientation:i,global:!0,metersPerUnit:qi,worldExtent:Yi})||this}return Bi(e,t),e}(Li),Vi=[new zi("CRS:84"),new zi("EPSG:4326","neu"),new zi("urn:ogc:def:crs:EPSG::4326","neu"),new zi("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new zi("urn:ogc:def:crs:OGC:1.3:CRS84"),new zi("urn:ogc:def:crs:OGC:2:84"),new zi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new zi("urn:x-ogc:def:crs:EPSG:4326","neu")],Ki={};function Ui(t,e,i){var n=t.getCode(),r=e.getCode();n in Ki||(Ki[n]={}),Ki[n][r]=i}var Hi={};function Zi(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function Ji(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function $i(t){!function(t,e){Hi[t]=e}(t.getCode(),t),Ui(t,t,Zi)}function Qi(t){return"string"==typeof t?Hi[t]||null:t||null}function tn(t){!function(t){t.forEach($i)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Ui(e,t,Zi)}))}))}function en(t,e){var i=function(t,e){var i;return t in Ki&&e in Ki[t]&&(i=Ki[t][e]),i}(t.getCode(),e.getCode());return i||(i=Ji),i}function nn(t,e){return en(Qi(t),Qi(e))}function rn(t,e,i){return yi(t,nn(e,i))}var on,sn,an,hn=null;function ln(t,e){return hn?rn(t,e,hn):t}tn(Ni),tn(Vi),on=Ni,sn=Wi,an=Xi,Vi.forEach((function(t){on.forEach((function(e){Ui(t,e,sn),Ui(e,t,an)}))}));new Array(6);function cn(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function un(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function fn(t,e,i,n,r,o,s,a){var h=Math.sin(o),l=Math.cos(o);return t[0]=n*l,t[1]=r*h,t[2]=-n*h,t[3]=r*l,t[4]=s*n*l-a*n*h+e,t[5]=s*r*h+a*r*l+i,t}function pn(t,e){var i,n=(i=e)[0]*i[3]-i[1]*i[2];_e(0!==n,32);var r=e[0],o=e[1],s=e[2],a=e[3],h=e[4],l=e[5];return t[0]=a/n,t[1]=-o/n,t[2]=-s/n,t[3]=r/n,t[4]=(s*l-a*h)/n,t[5]=-(r*l-o*h)/n,t}function dn(t){return"matrix("+t.join(", ")+")"}var _n=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gn=[1,0,0,1,0,0],yn=function(t){function e(){var e,i,n,r,o,s=t.call(this)||this;return s.extent_=[1/0,1/0,-1/0,-1/0],s.extentRevision_=-1,s.simplifiedGeometryMaxMinSquaredTolerance=0,s.simplifiedGeometryRevision=0,s.simplifyTransformedInternal=(e=function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)},o=!1,function(){var t=Array.prototype.slice.call(arguments);return o&&this===r&&bt(t,n)||(o=!0,r=this,n=t,i=e.apply(this,arguments)),i}),s}return _n(e,t),e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},e.prototype.clone=function(){return It()},e.prototype.closestPointXY=function(t,e,i,n){return It()},e.prototype.containsXY=function(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return It()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){It()},e.prototype.scale=function(t,e,i){It()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return It()},e.prototype.getType=function(){return It()},e.prototype.applyTransform=function(t){It()},e.prototype.intersectsExtent=function(t){return It()},e.prototype.translate=function(t,e){It()},e.prototype.transform=function(t,e){var i=Qi(t),n=i.getUnits()==Mi.TILE_PIXELS?function(t,n,r){var o=i.getExtent(),s=i.getWorldExtent(),a=fi(s)/fi(o);return fn(gn,s[0],s[3],a,-a,0,0,0),ki(t,0,t.length,r,gn,n),nn(i,e)(t,n,r)}:nn(i,e);return this.applyTransform(n),this},e}(oe),vn="XY",mn="XYZ",wn="XYM",xn="XYZM",Sn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Cn(t){var e;return t==vn?e=2:t==mn||t==wn?e=3:t==xn&&(e=4),e}var bn=function(t){function e(){var e=t.call(this)||this;return e.layout=vn,e.stride=2,e.flatCoordinates=null,e}return Sn(e,t),e.prototype.computeExtent=function(t){return ii(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return It()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=Cn(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){It()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=Cn(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=vn,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=vn:3==t?e=mn:4==t&&(e=xn);return(e)}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Pi(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var r=i;r||(r=ui(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,i,n,r,o,s,a){for(var h=a||[],l=s[0],c=s[1],u=0,f=e;f<i;f+=n){var p=t[f]-l,d=t[f+1]-c;h[u++]=l+r*p,h[u++]=c+o*d;for(var _=f+2;_<f+n;++_)h[u++]=t[_]}a&&h.length!=u&&(h.length=u)}(o,0,o.length,s,t,n,r,o),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Ii(i,0,i.length,n,t,e,i),this.changed()}},e}(yn);function On(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}function En(t,e,i,n){for(var r=0,o=i.length;r<o;++r)for(var s=i[r],a=0;a<n;++a)t[e++]=s[a];return e}function kn(t,e,i,n,r){for(var o=r||[],s=0,a=0,h=i.length;a<h;++a){var l=En(t,e,i[a],n);o[s++]=l,e=l}return o.length=s,o}var Pn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),In=function(t){function e(e,i,n){var r=t.call(this)||this;if(void 0!==n&&void 0===i)r.setFlatCoordinates(n,e);else{var o=i||0;r.setCenterAndRadius(e,o,n)}return r}return Pn(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=t-r[0],s=e-r[1],a=o*o+s*s;if(a<n){if(0===a)for(var h=0;h<this.stride;++h)i[h]=r[h];else{var l=this.getRadius()/Math.sqrt(a);i[0]=r[0]+l*o,i[1]=r[1]+l*s;for(h=2;h<this.stride;++h)i[h]=r[h]}return i.length=this.stride,a}return n},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,n=t-i[0],r=e-i[1];return n*n+r*r<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return ti(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return Ei},e.prototype.intersectsExtent=function(t){if(gi(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||hi(t,this.intersectsCoordinate.bind(this)))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(var r=1;r<e;++r)n[e+r]=t[r];this.setFlatCoordinates(this.layout,n),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,r=On(n,0,t,this.stride);n[r++]=n[0]+e;for(var o=1,s=this.stride;o<s;++o)n[r++]=n[o];n.length=r,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter(Pi(i,0,i.length,n,t,e,i)),this.changed()},e.prototype.translate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter(Ii(i,0,i.length,n,t,e,i)),this.changed()},e}(bn);In.prototype.transform;var Tn=In;function Dn(t,e,i,n,r,o,s){var a,h=t[e],l=t[e+1],c=t[i]-h,u=t[i+1]-l;if(0===c&&0===u)a=e;else{var f=((r-h)*c+(o-l)*u)/(c*c+u*u);if(f>1)a=i;else{if(f>0){for(var p=0;p<n;++p)s[p]=Fe(t[e+p],t[i+p],f);return void(s.length=n)}a=e}}for(p=0;p<n;++p)s[p]=t[a+p];s.length=n}function Mn(t,e,i,n,r){var o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],h=t[e+1],l=Me(o,s,a,h);l>r&&(r=l),o=a,s=h}return r}function Ln(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=Mn(t,e,a,n,r),e=a}return r}function Fn(t,e,i,n,r,o,s,a,h,l,c){if(e==i)return l;var u,f;if(0===r){if((f=Me(s,a,t[e],t[e+1]))<l){for(u=0;u<n;++u)h[u]=t[e+u];return h.length=n,f}return l}for(var p=c||[NaN,NaN],d=e+n;d<i;)if(Dn(t,d-n,d,n,s,a,p),(f=Me(s,a,p[0],p[1]))<l){for(l=f,u=0;u<n;++u)h[u]=p[u];h.length=n,d+=n}else d+=n*Math.max((Math.sqrt(f)-Math.sqrt(l))/r|0,1);if(o&&(Dn(t,i-n,e,n,s,a,p),(f=Me(s,a,p[0],p[1]))<l)){for(l=f,u=0;u<n;++u)h[u]=p[u];h.length=n}return l}function Rn(t,e,i,n,r,o,s,a,h,l,c){for(var u=c||[NaN,NaN],f=0,p=i.length;f<p;++f){var d=i[f];l=Fn(t,e,d,n,r,o,s,a,h,l,u),e=d}return l}function An(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=e;a<i;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function jn(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,h=i.length;a<h;++a){var l=i[a];o[s++]=An(t,e,l,n,o[s]),e=l}return o.length=s,o}function Gn(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,h=i.length;a<h;++a){var l=i[a];o[s++]=jn(t,e,l,n,o[s]),e=l[l.length-1]}return o.length=s,o}function Nn(t,e,i,n,r,o){var s=NaN,a=NaN,h=(i-e)/n;if(1===h)s=t[e],a=t[e+1];else if(2==h)s=(1-r)*t[e]+r*t[e+n],a=(1-r)*t[e+1]+r*t[e+n+1];else if(0!==h){for(var l=t[e],c=t[e+1],u=0,f=[0],p=e+n;p<i;p+=n){var d=t[p],_=t[p+1];u+=Math.sqrt((d-l)*(d-l)+(_-c)*(_-c)),f.push(u),l=d,c=_}var g=r*u,y=function(t,e,i){for(var n,r,o=i||xt,s=0,a=t.length,h=!1;s<a;)(r=+o(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,h=!r);return h?s:~s}(f,g);if(y<0){var v=(g-f[-y-2])/(f[-y-1]-f[-y-2]),m=e+(-y-2)*n;s=Fe(t[m],t[m+n],v),a=Fe(t[m+1],t[m+n+1],v)}else s=t[e+y*n],a=t[e+y*n+1]}return o?(o[0]=s,o[1]=a,o):[s,a]}function Wn(t,e,i,n,r,o){if(i==e)return null;var s;if(r<t[e+n-1])return o?((s=t.slice(e,e+n))[n-1]=r,s):null;if(t[i-1]<r)return o?((s=t.slice(i-n,i))[n-1]=r,s):null;if(r==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,h=i/n;a<h;){var l=a+h>>1;r<t[(l+1)*n-1]?h=l:a=l+1}var c=t[a*n-1];if(r==c)return t.slice((a-1)*n,(a-1)*n+n);var u=(r-c)/(t[(a+1)*n-1]-c);s=[];for(var f=0;f<n-1;++f)s.push(Fe(t[(a-1)*n+f],t[a*n+f],u));return s.push(r),s}function Xn(t,e,i,n,r){return!hi(r,(function(r){return!Bn(t,e,i,n,r[0],r[1])}))}function Bn(t,e,i,n,r,o){for(var s=0,a=t[i-n],h=t[i-n+1];e<i;e+=n){var l=t[e],c=t[e+1];h<=o?c>o&&(l-a)*(o-h)-(r-a)*(c-h)>0&&s++:c<=o&&(l-a)*(o-h)-(r-a)*(c-h)<0&&s--,a=l,h=c}return 0!==s}function Yn(t,e,i,n,r,o){if(0===i.length)return!1;if(!Bn(t,e,i[0],n,r,o))return!1;for(var s=1,a=i.length;s<a;++s)if(Bn(t,i[s-1],i[s],n,r,o))return!1;return!0}function qn(t,e,i,n,r){for(var o,s=[t[e],t[e+1]],a=[];e+n<i;e+=n){if(a[0]=t[e+n],a[1]=t[e+n+1],o=r(s,a))return o;s[0]=a[0],s[1]=a[1]}return!1}function zn(t,e,i,n,r){var o=si([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!gi(r,o)&&(!!Ze(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||qn(t,e,i,n,(function(t,e){return function(t,e,i){var n=!1,r=$e(t,e),o=$e(t,i);if(r===Be||o===Be)n=!0;else{var s=t[0],a=t[1],h=t[2],l=t[3],c=e[0],u=e[1],f=i[0],p=i[1],d=(p-u)/(f-c),_=void 0,g=void 0;o&Ye&&!(r&Ye)&&(n=(_=f-(p-l)/d)>=s&&_<=h),n||!(o&qe)||r&qe||(n=(g=p-(f-h)*d)>=a&&g<=l),n||!(o&ze)||r&ze||(n=(_=f-(p-a)/d)>=s&&_<=h),n||!(o&Ve)||r&Ve||(n=(g=p-(f-s)*d)>=a&&g<=l)}return n}(r,t,e)})))))}function Vn(t,e,i,n,r){if(!function(t,e,i,n,r){return!!zn(t,e,i,n,r)||(!!Bn(t,e,i,n,r[0],r[1])||(!!Bn(t,e,i,n,r[0],r[3])||(!!Bn(t,e,i,n,r[2],r[1])||!!Bn(t,e,i,n,r[2],r[3]))))}(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if(Xn(t,i[o-1],i[o],n,r)&&!zn(t,i[o-1],i[o],n,r))return!1;return!0}function Kn(t,e,i,n){for(var r=t[e],o=t[e+1],s=0,a=e+n;a<i;a+=n){var h=t[a],l=t[a+1];s+=Math.sqrt((h-r)*(h-r)+(l-o)*(l-o)),r=h,o=l}return s}function Un(t,e,i,n,r,o,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var h=new Array(a);h[0]=1,h[a-1]=1;for(var l=[e,i-n],c=0;l.length>0;){for(var u=l.pop(),f=l.pop(),p=0,d=t[f],_=t[f+1],g=t[u],y=t[u+1],v=f+n;v<u;v+=n){var m=De(t[v],t[v+1],d,_,g,y);m>p&&(c=v,p=m)}p>r&&(h[(c-e)/n]=1,f+n<c&&l.push(f,c),c+n<u&&l.push(c,u))}for(v=0;v<a;++v)h[v]&&(o[s++]=t[e+v*n],o[s++]=t[e+v*n+1]);return s}function Hn(t,e,i,n,r,o,s,a){for(var h=0,l=i.length;h<l;++h){var c=i[h];s=Un(t,e,c,n,r,o,s),a.push(s),e=c}return s}function Zn(t,e){return e*Math.round(t/e)}function Jn(t,e,i,n,r,o,s){if(e==i)return s;var a,h,l=Zn(t[e],r),c=Zn(t[e+1],r);e+=n,o[s++]=l,o[s++]=c;do{if(a=Zn(t[e],r),h=Zn(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=h,s}while(a==l&&h==c);for(;e<i;){var u=Zn(t[e],r),f=Zn(t[e+1],r);if(e+=n,u!=a||f!=h){var p=a-l,d=h-c,_=u-l,g=f-c;p*g==d*_&&(p<0&&_<p||p==_||p>0&&_>p)&&(d<0&&g<d||d==g||d>0&&g>d)?(a=u,h=f):(o[s++]=a,o[s++]=h,l=a,c=h,a=u,h=f)}}return o[s++]=a,o[s++]=h,s}function $n(t,e,i,n,r,o,s,a){for(var h=0,l=i.length;h<l;++h){var c=i[h];s=Jn(t,e,c,n,r,o,s),a.push(s),e=c}return s}var Qn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),tr=function(t){function e(e,i){var n=t.call(this)||this;return n.flatMidpoint_=null,n.flatMidpointRevision_=-1,n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return Qn(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?Ct(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<He(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return qn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=wn&&this.layout!=xn)return null;var i=void 0!==e&&e;return Wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Nn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return Kn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Un(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,vn)},e.prototype.getType=function(){return mi},e.prototype.intersectsExtent=function(t){return zn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=En(this.flatCoordinates,0,t,this.stride),this.changed()},e}(bn),er=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ir=function(t){function e(e,i,n){var r=t.call(this)||this;if(r.ends_=[],r.maxDelta_=-1,r.maxDeltaRevision_=-1,Array.isArray(e[0]))r.setCoordinates(e,i);else if(void 0!==i&&n)r.setFlatCoordinates(i,e),r.ends_=n;else{for(var o=r.getLayout(),s=e,a=[],h=[],l=0,c=s.length;l<c;++l){var u=s[l];0===l&&(o=u.getLayout()),Ct(a,u.getFlatCoordinates()),h.push(a.length)}r.setFlatCoordinates(o,a),r.ends_=h}return r}return er(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?Ct(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<He(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ln(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Rn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=wn&&this.layout!=xn||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,r=void 0!==i&&i;return function(t,e,i,n,r,o,s){if(s)return Wn(t,e,i[i.length-1],n,r,o);var a;if(r<t[n-1])return o?((a=t.slice(0,n))[n-1]=r,a):null;if(t[t.length-1]<r)return o?((a=t.slice(t.length-n))[n-1]=r,a):null;for(var h=0,l=i.length;h<l;++h){var c=i[h];if(e!=c){if(r<t[e+n-1])return null;if(r<=t[c-1])return Wn(t,e,c,n,r,!1);e=c}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,r)},e.prototype.getCoordinates=function(){return jn(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new tr(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],r=0,o=0,s=e.length;o<s;++o){var a=e[o],h=new tr(t.slice(r,a),i);n.push(h),r=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,r=this.stride,o=0,s=n.length;o<s;++o){var a=n[o];Ct(t,Nn(e,i,a,r,.5)),i=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=Hn(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,vn,n)},e.prototype.getType=function(){return Ci},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){if(zn(t,e,i[o],n,r))return!0;e=i[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=kn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(bn),nr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),rr=function(t){function e(e,i){var n=t.call(this)||this;return n.setCoordinates(e,i),n}return nr(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=Me(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,a=0;a<s;++a)i[a]=r[a];return i.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return e=this.flatCoordinates,i=t,n=e[0],r=e[1],ti(n,r,n,r,i);var e,i,n,r},e.prototype.getType=function(){return vi},e.prototype.intersectsExtent=function(t){return Je(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=On(this.flatCoordinates,0,t,this.stride),this.changed()},e}(bn),or=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sr=function(t){function e(e,i){var n=t.call(this)||this;return i&&!Array.isArray(e[0])?n.setFlatCoordinates(i,e):n.setCoordinates(e,i),n}return or(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?Ct(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){if(n<He(this.getExtent(),t,e))return n;for(var r=this.flatCoordinates,o=this.stride,s=0,a=r.length;s<a;s+=o){var h=Me(t,e,r[s],r[s+1]);if(h<n){n=h;for(var l=0;l<o;++l)i[l]=r[s+l];i.length=o}}return n},e.prototype.getCoordinates=function(){return An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new rr(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],r=0,o=t.length;r<o;r+=i){var s=new rr(t.slice(r,r+i),e);n.push(s)}return n},e.prototype.getType=function(){return Si},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,r=e.length;n<r;n+=i){if(Je(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=En(this.flatCoordinates,0,t,this.stride),this.changed()},e}(bn);function ar(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],h=t[e+1];r+=s*a-o*h,o=a,s=h}return r/2}function hr(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=ar(t,e,a,n),e=a}return r}var lr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cr=function(t){function e(e,i){var n=t.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return lr(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<He(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Un(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,vn)},e.prototype.getType=function(){return wi},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=En(this.flatCoordinates,0,t,this.stride),this.changed()},e}(bn);function ur(t,e,i,n,r,o,s){for(var a,h,l,c,u,f,p,d=r[o+1],_=[],g=0,y=i.length;g<y;++g){var v=i[g];for(c=t[v-n],f=t[v-n+1],a=e;a<v;a+=n)u=t[a],p=t[a+1],(d<=f&&p<=d||f<=d&&d<=p)&&(l=(d-f)/(p-f)*(u-c)+c,_.push(l)),c=u,f=p}var m=NaN,w=-1/0;for(_.sort(xt),c=_[0],a=1,h=_.length;a<h;++a){u=_[a];var x=Math.abs(u-c);x>w&&Yn(t,e,i,n,l=(c+u)/2,d)&&(m=l,w=x),c=u}return isNaN(m)&&(m=r[o]),s?(s.push(m,d,w),s):[m,d,w]}function fr(t,e,i,n){for(;e<i-n;){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}function pr(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],h=t[e+1];r+=(a-o)*(h+s),o=a,s=h}return r>0}function dr(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var h=i[s],l=pr(t,e,h,n);if(0===s){if(o&&l||!o&&!l)return!1}else if(o&&!l||!o&&l)return!1;e=h}return!0}function _r(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var h=i[s],l=pr(t,e,h,n);(0===s?o&&l||!o&&!l:o&&!l||!o&&l)&&fr(t,e,h,n),e=h}return e}function gr(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)e=_r(t,e,i[o],n,r);return e}var yr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vr=function(t){function e(e,i,n){var r=t.call(this)||this;return r.ends_=[],r.flatInteriorPointRevision_=-1,r.flatInteriorPoint_=null,r.maxDelta_=-1,r.maxDeltaRevision_=-1,r.orientedRevision_=-1,r.orientedFlatCoordinates_=null,void 0!==i&&n?(r.setFlatCoordinates(i,e),r.ends_=n):r.setCoordinates(e,i),r}return yr(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?Ct(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<He(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ln(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Rn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return Yn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return hr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?_r(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,jn(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=ui(this.getExtent());this.flatInteriorPoint_=ur(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new rr(this.getFlatInteriorPoint(),wn)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new cr(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o],h=new cr(e.slice(r,a),t);n.push(h),r=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;dr(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=_r(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=$n(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,vn,n)},e.prototype.getType=function(){return xi},e.prototype.intersectsExtent=function(t){return Vn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=kn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(bn),mr=vr;function wr(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=[e,i,e,r,n,r,n,i,e,i];return new vr(o,vn,[o.length])}function xr(t,e,i){for(var n=e||32,r=t.getStride(),o=t.getLayout(),s=t.getCenter(),a=r*(n+1),h=new Array(a),l=0;l<a;l+=r){h[l]=0,h[l+1]=0;for(var c=2;c<r;c++)h[l+c]=s[c]}var u=[h.length],f=new vr(h,o,u);return Sr(f,s,t.getRadius(),i),f}function Sr(t,e,i,n){for(var r=t.getFlatCoordinates(),o=t.getStride(),s=r.length/o-1,a=n||0,h=0;h<=s;++h){var l=h*o,c=a+2*Le(h,s)*Math.PI/s;r[l]=e[0]+i*Math.cos(c),r[l+1]=e[1]+i*Math.sin(c)}t.changed()}var Cr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),br=function(t){function e(e,i,n){var r=t.call(this)||this;if(r.endss_=[],r.flatInteriorPointsRevision_=-1,r.flatInteriorPoints_=null,r.maxDelta_=-1,r.maxDeltaRevision_=-1,r.orientedRevision_=-1,r.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var o=r.getLayout(),s=e,a=[],h=[],l=0,c=s.length;l<c;++l){var u=s[l];0===l&&(o=u.getLayout());for(var f=a.length,p=u.getEnds(),d=0,_=p.length;d<_;++d)p[d]+=f;Ct(a,u.getFlatCoordinates()),h.push(p)}i=o,e=a,n=h}return void 0!==i&&n?(r.setFlatCoordinates(i,e),r.endss_=n):r.setCoordinates(e,i),r}return Cr(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;Ct(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,r=(e=t.getEnds().slice()).length;n<r;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,n){return n<He(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=Ln(t,e,a,n,r),e=a[a.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,o,s,a,h,l,c){for(var u=c||[NaN,NaN],f=0,p=i.length;f<p;++f){var d=i[f];l=Rn(t,e,d,n,r,o,s,a,h,l,u),e=d[d.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,r,o){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var h=i[s];if(Yn(t,e,h,n,r,o))return!0;e=h[h.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=hr(t,e,a,n),e=a[a.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?gr(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,Gn(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,i,n){for(var r=[],o=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var h=i[s];o=ii(t,e,h[0],n),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=h[h.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,i,n,r){for(var o=[],s=0,a=i.length;s<a;++s){var h=i[s];o=ur(t,e,h,n,r,2*s,o),e=h[h.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new sr(this.getFlatInteriorPoints().slice(),wn)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(!dr(t,e,a,n,r))return!1;a.length&&(e=a[a.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=gr(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,r,o,s,a){for(var h=0,l=i.length;h<l;++h){var c=i[h],u=[];s=$n(t,e,c,n,r,o,s,u),a.push(u),e=c[c.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,vn,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),r=n[n.length-1];if(0!==e)for(var o=0,s=n.length;o<s;++o)n[o]-=e;return new mr(this.flatCoordinates.slice(e,r),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o].slice(),h=a[a.length-1];if(0!==r)for(var l=0,c=a.length;l<c;++l)a[l]-=r;var u=new mr(e.slice(r,h),t,a);n.push(u),r=h}return n},e.prototype.getType=function(){return bi},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(Vn(t,e,a,n,r))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,r){for(var o=r||[],s=0,a=0,h=i.length;a<h;++a){var l=kn(t,e,i[a],n,o[s]);o[s++]=l,e=l[l.length-1]}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(bn);var Or="active",Er=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var kr=function(t){function e(e){var i=t.call(this)||this;return e.handleEvent&&(i.handleEvent=e.handleEvent),i.map_=null,i.setActive(!0),i}return Er(e,t),e.prototype.getActive=function(){return this.get(Or)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(Or,t)},e.prototype.setMap=function(t){this.map_=t},e}(oe),Pr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var Ir=function(t){function e(e){var i=this,n=e||{};return i=t.call(this,n)||this,n.handleDownEvent&&(i.handleDownEvent=n.handleDownEvent),n.handleDragEvent&&(i.handleDragEvent=n.handleDragEvent),n.handleMoveEvent&&(i.handleMoveEvent=n.handleMoveEvent),n.handleUpEvent&&(i.handleUpEvent=n.handleUpEvent),n.stopDown&&(i.stopDown=n.stopDown),i.handlingDownUpSequence=!1,i.trackedPointers_={},i.targetPointers=[],i}return Pr(e,t),e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==me)this.handleDragEvent(t);else if(t.type==Se){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==xe){var n=this.handleDownEvent(t);n&&t.preventDefault(),this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==we&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===xe||e===me||e===Se}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==Se?delete this.trackedPointers_[i]:(t.type==xe||i in this.trackedPointers_)&&(this.trackedPointers_[i]=e),this.targetPointers=Rt(this.trackedPointers_)}},e}(kr),Tr="opacity",Dr="visible",Mr="extent",Lr="zIndex",Fr="maxResolution",Rr="minResolution",Ar="maxZoom",jr="minZoom",Gr="source",Nr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wr=function(t){function e(e){var i=t.call(this)||this,n=Lt({},e);return n[Tr]=void 0!==e.opacity?e.opacity:1,_e("number"==typeof n[Tr],64),n[Dr]=void 0===e.visible||e.visible,n[Lr]=e.zIndex,n[Fr]=void 0!==e.maxResolution?e.maxResolution:1/0,n[Rr]=void 0!==e.minResolution?e.minResolution:0,n[jr]=void 0!==e.minZoom?e.minZoom:-1/0,n[Ar]=void 0!==e.maxZoom?e.maxZoom:1/0,i.className_=void 0!==n.className?e.className:"ol-layer",delete n.className,i.setProperties(n),i.state_=null,i}return Nr(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=Ie(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i?i:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return It()},e.prototype.getLayerStatesArray=function(t){return It()},e.prototype.getExtent=function(){return this.get(Mr)},e.prototype.getMaxResolution=function(){return this.get(Fr)},e.prototype.getMinResolution=function(){return this.get(Rr)},e.prototype.getMinZoom=function(){return this.get(jr)},e.prototype.getMaxZoom=function(){return this.get(Ar)},e.prototype.getOpacity=function(){return this.get(Tr)},e.prototype.getSourceState=function(){return It()},e.prototype.getVisible=function(){return this.get(Dr)},e.prototype.getZIndex=function(){return this.get(Lr)},e.prototype.setExtent=function(t){this.set(Mr,t)},e.prototype.setMaxResolution=function(t){this.set(Fr,t)},e.prototype.setMinResolution=function(t){this.set(Rr,t)},e.prototype.setMaxZoom=function(t){this.set(Ar,t)},e.prototype.setMinZoom=function(t){this.set(jr,t)},e.prototype.setOpacity=function(t){_e("number"==typeof t,64),this.set(Tr,t)},e.prototype.setVisible=function(t){this.set(Dr,t)},e.prototype.setZIndex=function(t){this.set(Lr,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(oe),Xr="prerender",Br="postrender",Yr="precompose",qr="undefined",zr="ready",Vr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var Kr=function(t){function e(e){var i=this,n=Lt({},e);delete n.source,(i=t.call(this,n)||this).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,e.render&&(i.render=e.render),e.map&&i.setMap(e.map),i.addEventListener(re(Gr),i.handleSourcePropertyChange_);var r=e.source?e.source:null;return i.setSource(r),i}return Vr(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Gr)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():qr},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Nt(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=jt(t,zt,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},e.prototype.render=function(t,e){var i=this.getRenderer();if(i.prepareFrame(t))return i.renderFrame(t,e)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Nt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Nt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=jt(t,Yr,(function(t){t.frameState.layerStatesArray.push(this.getLayerState(!1))}),this),this.mapRenderKey_=jt(this,zt,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Gr,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.setSource(null),t.prototype.disposeInternal.call(this)},e}(Wr),Ur=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Hr=/^([a-z]*)$|^hsla?\(.*\)$/i;function Zr(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}var Jr,$r,Qr=(Jr={},$r=0,function(t){var e;if(Jr.hasOwnProperty(t))e=Jr[t];else{if($r>=1024){var i=0;for(var n in Jr)0==(3&i++)&&(delete Jr[n],--$r)}e=function(t){var e,i,n,r,o;if(Hr.exec(t)&&(t=Zr(t)),Ur.exec(t)){var s=t.length-1,a=void 0;a=s<=4?1:2;var h=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),i=parseInt(t.substr(1+1*a,a),16),n=parseInt(t.substr(1+2*a,a),16),r=h?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,h&&(r=(r<<4)+r)),o=[e,i,n,r/255]}else 0==t.indexOf("rgba(")?eo(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),eo(o)):_e(!1,14);return o}(t),Jr[t]=e,++$r}return e});function to(t){return Array.isArray(t)?t:Qr(t)}function eo(t){return t[0]=Ie(t[0]+.5|0,0,255),t[1]=Ie(t[1]+.5|0,0,255),t[2]=Ie(t[2]+.5|0,0,255),t[3]=Ie(t[3],0,1),t}function io(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function no(t){return Array.isArray(t)?io(t):t}var ro,oo=0,so=1,ao=2,ho=3,lo=function(){var t,e={};return function(i){if(t||(t=document.createElement("div").style),!(i in e)){t.font=i;var n=t.fontFamily,r=t.fontWeight,o=t.fontStyle;if(t.font="",!n)return null;var s=n.split(/,\s?/);e[i]={families:s,weight:r,style:o}}return e[i]}}(),co=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uo=function(t){function e(e){var i=t.call(this)||this;return i.highWaterMark=void 0!==e?e:2048,i.count_=0,i.entries_={},i.oldest_=null,i.newest_=null,i}return co(e,t),e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(Kt)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},e.prototype.get=function(t,e){var i=this.entries_[t];return _e(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_},e.prototype.remove=function(t){var e=this.entries_[t];return _e(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){_e(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e}(qt),fo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),po=function(t){function e(e){var i=t.call(this,e)||this;return i.consumers={},i}return fo(e,t),e.prototype.clear=function(){this.consumers={},t.prototype.clear.call(this)},e.prototype.get=function(e,i){var n=t.prototype.get.call(this,e),r=Dt(i);return r in this.consumers||(this.consumers[r]={}),this.consumers[r][e]=!0,n},e.prototype.prune=function(){t:for(;this.canExpireCache();){var t=this.peekLastKey();for(var e in this.consumers)if(t in this.consumers[e])break t;var i=this.pop();for(var e in i.width=0,i.height=0,this.consumers)delete this.consumers[e][t]}},e.prototype.release=function(t){delete this.consumers[Dt(t)]},e}(uo),_o=[],go=[0,0,0,0],yo=new po,vo={},mo=null,wo={},xo=function(){var t,e,i=vo,n=["monospace","serif"],r=n.length,o="wmytzilWMYTZIL@#/&?$%10";function s(t,i,s){for(var a=So(),h=!0,l=0;l<r;++l){var c=n[l];if(a.font=t+" "+i+" 32px "+c,e=a.measureText(o).width,s!=c){a.font=t+" "+i+" 32px "+s+","+c;var u=a.measureText(o).width;h=h&&u!=e}}return!!h}function a(){var e=!0;for(var n in i)i[n]<100&&(s.apply(this,n.split("\n"))?(i[n]=100,Ft(wo),mo=null,ro=void 0,yo.getCount()&&yo.clear()):(++i[n],e=!1));e&&(clearInterval(t),t=void 0)}return function(e){var n=lo(e);if(n)for(var r=n.families,o=0,h=r.length;o<h;++o){var l=r[o],c=n.style+"\n"+n.weight+"\n"+l;c in i||(i[c]=100,s(n.style,n.weight,l)||(i[c]=0,void 0===t&&(t=setInterval(a,32))))}}}();function So(){return mo||(mo=se(1,1)),mo}var Co,bo,Oo=(bo=wo,function(t){var e=bo[t];return null==e&&(Co||((Co=document.createElement("div")).innerHTML="M",Co.style.margin="0 !important",Co.style.padding="0 !important",Co.style.position="absolute !important",Co.style.left="-99999px !important"),Co.style.font=t,document.body.appendChild(Co),e=Co.offsetHeight,bo[t]=e,document.body.removeChild(Co)),e});function Eo(t,e){var i=So();return t!=ro&&(i.font=t,ro=i.font),i.measureText(e).width}function ko(t,e,i){if(e in i)return i[e];var n=Eo(t,e);return i[e]=n,n}function Po(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))}var Io=[1,0,0,1,0,0];function To(t,e,i,n,r,o,s,a,h,l,c){var u;1!=i&&(u=t.globalAlpha,t.globalAlpha=u*i),e&&t.setTransform.apply(t,e),t.drawImage(n,r,o,s,a,h,l,s*c,a*c),1!=i&&(t.globalAlpha=u),e&&t.setTransform.apply(t,Io)}var Do=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getAnchor=function(){return It()},t.prototype.getImage=function(t){return It()},t.prototype.getHitDetectionImage=function(t){return It()},t.prototype.getImageState=function(){return It()},t.prototype.getImageSize=function(){return It()},t.prototype.getHitDetectionImageSize=function(){return It()},t.prototype.getOrigin=function(){return It()},t.prototype.getSize=function(){return It()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t){It()},t.prototype.load=function(){It()},t.prototype.unlistenImageChange=function(t){It()},t}(),Mo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Lo=function(t){function e(e){var i=this,n=void 0!==e.rotateWithView&&e.rotateWithView;return(i=t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1})||this).canvas_=null,i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius_=void 0!==e.radius?e.radius:e.radius1,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.anchor_=null,i.size_=null,i.imageSize_=null,i.hitDetectionImageSize_=null,i.render(),i}return Mo(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return ao},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.render=function(){var t,e="round",i="round",n=0,r=null,o=0,s=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=no(t),void 0===(s=this.stroke_.getWidth())&&(s=1),r=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset(),void 0===(i=this.stroke_.getLineJoin())&&(i="round"),void 0===(e=this.stroke_.getLineCap())&&(e="round"),void 0===(n=this.stroke_.getMiterLimit())&&(n=10));var a=2*(this.radius_+s)+1,h={strokeStyle:t,strokeWidth:s,size:a,lineCap:e,lineDash:r,lineDashOffset:o,lineJoin:i,miterLimit:n},l=se(a,a);this.canvas_=l.canvas;var c=a=this.canvas_.width;this.draw_(h,l,0,0),this.createHitDetectionCanvas_(h),this.anchor_=[a/2,a/2],this.size_=[a,a],this.imageSize_=[c,c]},e.prototype.draw_=function(t,e,i,n){var r,o,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,s=r%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var l=this.fill_.getColor();null===l&&(l="#000"),e.fillStyle=no(l),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var e=this.fill_.getColor(),i=0;if("string"==typeof e&&(e=to(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){var n=se(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n,0,0)}}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o=void 0!==this.radius2_?this.radius2_:this.radius_;o!==this.radius_&&(r*=2);var s=void 0,a=void 0,h=void 0;for(s=0;s<=r;s++)h=2*s*Math.PI/r-Math.PI/2+this.angle_,a=s%2==0?this.radius_:o,e.lineTo(t.size/2+a*Math.cos(h),t.size/2+a*Math.sin(h))}e.fillStyle="#000",e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e}(Do),Fo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ro=function(t){function e(e){var i=e||{};return t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke})||this}return Fo(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Lo),Ao=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),jo=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}(),Go=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Bo,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Bo,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();var No=null;function Wo(t,e){if(!No){var i=new Ao({color:"rgba(255,255,255,0.4)"}),n=new jo({color:"#3399CC",width:1.25});No=[new Go({image:new Ro({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return No}function Xo(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[xi]=[new Go({fill:new Ao({color:[255,255,255,.5]})})],t[bi]=t[xi],t[mi]=[new Go({stroke:new jo({color:e,width:5})}),new Go({stroke:new jo({color:i,width:3})})],t[Ci]=t[mi],t[Ei]=t[xi].concat(t[mi]),t[vi]=[new Go({image:new Ro({radius:6,fill:new Ao({color:i}),stroke:new jo({color:e,width:1.5})}),zIndex:1/0})],t[Si]=t[vi],t[Oi]=t[xi].concat(t[mi],t[vi]),t}function Bo(t){return t.getGeometry()}var Yo=Go,qo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),zo="renderOrder",Vo=function(t){function e(e){var i=this,n=e||{},r=Lt({},n);return delete r.style,delete r.renderBuffer,delete r.updateWhileAnimating,delete r.updateWhileInteracting,(i=t.call(this,r)||this).declutter_=void 0!==n.declutter&&n.declutter,i.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(n.style),i.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,i.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,i}return qo(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(zo)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(zo,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Wo,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;if(Array.isArray(t))i=t;else _e("function"==typeof t.getZIndex,41),i=[t];e=function(){return i}}return e}(this.style_),this.changed()},e}(Kr),Ko=0,Uo=1,Ho=function(){function t(){}return t.prototype.drawCustom=function(t,e,i){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,e){},t.prototype.drawFeature=function(t,e){},t.prototype.drawGeometryCollection=function(t,e){},t.prototype.drawLineString=function(t,e){},t.prototype.drawMultiLineString=function(t,e){},t.prototype.drawMultiPoint=function(t,e){},t.prototype.drawMultiPolygon=function(t,e){},t.prototype.drawPoint=function(t,e){},t.prototype.drawPolygon=function(t,e){},t.prototype.drawText=function(t,e){},t.prototype.setFillStrokeStyle=function(t,e){},t.prototype.setImageStyle=function(t,e){},t.prototype.setTextStyle=function(t,e){},t}(),Zo={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Jo=[Zo.FILL],$o=[Zo.STROKE],Qo=[Zo.BEGIN_PATH],ts=[Zo.CLOSE_PATH],es=Zo,is=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ns=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.tolerance=e,o.maxExtent=i,o.pixelRatio=r,o.maxLineWidth=0,o.resolution=n,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return is(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=n);var h,l,c,u=t[e],f=t[e+1],p=this.tmpCoordinate_,d=!0;for(h=e+n;h<i;h+=n)p[0]=t[h],p[1]=t[h+1],(c=$e(a,p))!==l?(d&&(this.coordinates[s++]=u,this.coordinates[s++]=f),this.coordinates[s++]=p[0],this.coordinates[s++]=p[1],d=!1):c===Be?(this.coordinates[s++]=p[0],this.coordinates[s++]=p[1],d=!1):d=!0,u=p[0],f=p[1],l=c;return(r&&d||h===e+n)&&(this.coordinates[s++]=u,this.coordinates[s++]=f),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],h=this.appendFlatCoordinates(t,e,a,n,!1,!1);r.push(h),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,r,o,s,a,h=t.getType(),l=t.getStride(),c=this.coordinates.length;if(h==bi){n=(t=t).getOrientedFlatCoordinates(),s=[];var u=t.getEndss();a=0;for(var f=0,p=u.length;f<p;++f){var d=[];a=this.drawCustomCoordinates_(n,a,u[f],l,d),s.push(d)}this.instructions.push([es.CUSTOM,c,s,t,i,Gn])}else h==xi||h==Ci?(o=[],n=h==xi?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),l,o),this.instructions.push([es.CUSTOM,c,o,t,i,jn])):h==mi||h==Si?(n=t.getFlatCoordinates(),r=this.appendFlatCoordinates(n,0,n.length,l,!1,!1),this.instructions.push([es.CUSTOM,c,r,t,i,An])):h==vi&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),r=this.coordinates.length,this.instructions.push([es.CUSTOM,c,r,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[es.BEGIN_GEOMETRY,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[es.BEGIN_GEOMETRY,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==es.END_GEOMETRY?o=t:n==es.BEGIN_GEOMETRY&&(i[2]=t,St(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=no(n||"#000")}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=no(r||"#000");var o=e.getLineCap();i.lineCap=void 0!==o?o:"round";var s=e.getLineDash();i.lineDash=s?s.slice():_o;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var h=e.getLineJoin();i.lineJoin=void 0!==h?h:"round";var l=e.getWidth();i.lineWidth=void 0!==l?l:1;var c=e.getMiterLimit();i.miterLimit=void 0!==c?c:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[es.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[es.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!bt(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=h)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[es.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(e=this.maxExtent,i?(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i):e.slice()),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Ue(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}var e,i;return this.bufferedMaxExtent_},e}(Ho),rs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),os=function(t){function e(e,i,n,r){var o=t.call(this,e,i,n,r)||this;return o.declutterGroups_=null,o.hitDetectionImage_=null,o.image_=null,o.anchorX_=void 0,o.anchorY_=void 0,o.height_=void 0,o.opacity_=void 0,o.originX_=void 0,o.originY_=void 0,o.rotateWithView_=void 0,o.rotation_=void 0,o.scale_=void 0,o.width_=void 0,o}return rs(e,t),e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([es.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([es.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([es.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([es.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),r=t.getHitDetectionImage(1),o=t.getImage(1),s=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroups_=e,this.hitDetectionImage_=r,this.image_=o,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=n[0]},e}(ns),ss=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),as=function(t){function e(e,i,n,r){return t.call(this,e,i,n,r)||this}return ss(e,t),e.prototype.drawFlatCoordinates_=function(t,e,i,n){var r=this.coordinates.length,o=this.appendFlatCoordinates(t,e,i,n,!1,!1),s=[es.MOVE_TO_LINE_TO,r,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([es.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Qo);var o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push($o),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([es.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Qo);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),h=0,l=0,c=o.length;l<c;++l)h=this.drawFlatCoordinates_(s,h,o[l],a);this.hitDetectionInstructions.push($o),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push($o),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push($o),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(Qo)},e}(ns),hs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ls=function(t){function e(e,i,n,r){return t.call(this,e,i,n,r)||this}return hs(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var r=this.state,o=void 0!==r.fillStyle,s=void 0!==r.strokeStyle,a=i.length;this.instructions.push(Qo),this.hitDetectionInstructions.push(Qo);for(var h=0;h<a;++h){var l=i[h],c=this.coordinates.length,u=this.appendFlatCoordinates(t,e,l,n,!0,!s),f=[es.MOVE_TO_LINE_TO,c,u];this.instructions.push(f),this.hitDetectionInstructions.push(f),s&&(this.instructions.push(ts),this.hitDetectionInstructions.push(ts)),e=l}return o&&(this.instructions.push(Jo),this.hitDetectionInstructions.push(Jo)),s&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),e},e.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([es.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([es.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,s,!1,!1);var h=[es.CIRCLE,a];this.instructions.push(Qo,h),this.hitDetectionInstructions.push(Qo,h),void 0!==i.fillStyle&&(this.instructions.push(Jo),this.hitDetectionInstructions.push(Jo)),void 0!==i.strokeStyle&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([es.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([es.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([es.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([es.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),h=0,l=0,c=o.length;l<c;++l)h=this.drawFlatCoordinatess_(s,h,o[l],a);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var i=this.coordinates,n=0,r=i.length;n<r;++n)i[n]=Zn(i[n],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(ns);function cs(t,e,i,n,r){var o,s,a,h,l,c,u,f,p,d=i,_=i,g=0,y=0,v=i;for(o=i;o<n;o+=r){var m=e[o],w=e[o+1];void 0!==h&&(f=m-h,p=w-l,a=Math.sqrt(f*f+p*p),void 0!==c&&(y+=s,Math.acos((c*f+u*p)/(s*a))>t&&(y>g&&(g=y,d=v,_=o),y=0,v=o-r)),s=a,c=f,u=p),h=m,l=w}return(y+=a)>g?[v,o]:[d,_]}var us="line",fs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ps={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},ds={Circle:ls,Default:ns,Image:os,LineString:as,Polygon:ls,Text:function(t){function e(e,i,n,r){var o=t.call(this,e,i,n,r)||this;return o.declutterGroups_,o.labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",yo.prune(),o}return fs(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(i||n)){var o,s,a=this.coordinates.length,h=t.getType(),l=null,c=2,u=2;if(r.placement===us){if(!gi(this.getBufferedMaxExtent(),t.getExtent()))return;var f=void 0;if(l=t.getFlatCoordinates(),u=t.getStride(),h==mi)f=[l.length];else if(h==Ci)f=t.getEnds();else if(h==xi)f=t.getEnds().slice(0,1);else if(h==bi){var p=t.getEndss();for(f=[],o=0,s=p.length;o<s;++o)f.push(p[o][0])}this.beginGeometry(t,e);for(var d=r.textAlign,_=0,g=void 0,y=0,v=f.length;y<v;++y){if(null==d){var m=cs(r.maxAngle,l,_,f[y],u);_=m[0],g=m[1]}else g=f[y];for(o=_;o<g;o+=u)this.coordinates.push(l[o],l[o+1]);c=this.coordinates.length,_=f[y];var w=this.declutterGroups_?0===y?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(a,c,w),a=c}this.endGeometry(e)}else{var x=null;switch(r.overflow||(x=[]),h){case vi:case Si:c=(l=t.getFlatCoordinates()).length;break;case mi:l=t.getFlatMidpoint();break;case Ei:l=t.getCenter();break;case Ci:c=(l=t.getFlatMidpoints()).length;break;case xi:l=t.getFlatInteriorPoint(),r.overflow||x.push(l[2]/this.resolution),u=3;break;case bi:var S=t.getFlatInteriorPoints();for(l=[],o=0,s=S.length;o<s;o+=3)r.overflow||x.push(S[o+2]/this.resolution),l.push(S[o],S[o+1]);if(0==(c=l.length))return}c=this.appendFlatCoordinates(l,0,c,u,!1,!1),this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var C=this.pixelRatio;this.instructions.push([es.DRAW_IMAGE,a,c,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,r.padding==go?go:r.padding.map((function(t){return t*C})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,x]),this.hitDetectionInstructions.push([es.DRAW_IMAGE,a,c,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,r.padding,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,x]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||"center",textBaseline:e.textBaseline||"middle",scale:e.scale});var o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,r=this.textState_,o=this.strokeKey_,s=this.textKey_,a=this.fillKey_;this.saveTextStates_();var h=this.pixelRatio,l=ps[r.textBaseline],c=this.textOffsetY_*h,u=this.text_,f=r.scale,p=n?n.lineWidth*f/2:0;this.instructions.push([es.DRAW_CHARS,t,e,l,i,r.overflow,a,r.maxAngle,h,c,o,p*h,u,s,1]),this.hitDetectionInstructions.push([es.DRAW_CHARS,t,e,l,i,r.overflow,a,r.maxAngle,1,c,o,p,u,s,1/h])},e.prototype.setTextStyle=function(t,e){var i,n,r;if(t){this.declutterGroups_=e;var o=t.getFill();o?((n=this.textFillState_)||(n={},this.textFillState_=n),n.fillStyle=no(o.getColor()||"#000")):(n=null,this.textFillState_=n);var s=t.getStroke();if(s){(r=this.textStrokeState_)||(r={},this.textStrokeState_=r);var a=s.getLineDash(),h=s.getLineDashOffset(),l=s.getWidth(),c=s.getMiterLimit();r.lineCap=s.getLineCap()||"round",r.lineDash=a?a.slice():_o,r.lineDashOffset=void 0===h?0:h,r.lineJoin=s.getLineJoin()||"round",r.lineWidth=void 0===l?1:l,r.miterLimit=void 0===c?10:c,r.strokeStyle=no(s.getColor()||"#000")}else r=null,this.textStrokeState_=r;i=this.textState_;var u=t.getFont()||"10px sans-serif";xo(u);var f=t.getScale();i.overflow=t.getOverflow(),i.font=u,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||"middle",i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||go,i.scale=void 0===f?1:f;var p=t.getOffsetX(),d=t.getOffsetY(),_=t.getRotateWithView(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==_&&_,this.textRotation_=void 0===g?0:g,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:Dt(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+Dt(n.fillStyle):""}else this.text_=""},e}(ns)},_s=function(){function t(t,e,i,n,r){this.declutter_=r,this.declutterGroups_=null,this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}return t.prototype.addDeclutter=function(t){var e=null;return this.declutter_&&(t?(e=this.declutterGroups_)[0][4]++:(e=[[1/0,1/0,-1/0,-1/0]],this.declutterGroups_=e,e[0].push(1))),e},t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var n in i){var r=i[n].finish();t[e][n]=r}}return t},t.prototype.getBuilder=function(t,e){var i=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);var r=n[e];void 0===r&&(r=new(0,ds[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r);return r},t}(),gs="Circle",ys="Default",vs="Image",ms="LineString",ws="Polygon",xs="Text";function Ss(t,e,i,n,r,o,s,a,h,l,c){for(var u,f,p=[],d=t[e]>t[i-n],_=r.length,g=t[e],y=t[e+1],v=t[e+=n],m=t[e+1],w=0,x=Math.sqrt(Math.pow(v-g,2)+Math.pow(m-y,2)),S=!1,C=0;C<_;++C){for(var b=r[u=d?_-C-1:C],O=a*h(l,b,c),E=o+O/2;e<i-n&&w+x<E;)g=v,y=m,v=t[e+=n],m=t[e+1],w+=x,x=Math.sqrt(Math.pow(v-g,2)+Math.pow(m-y,2));var k=E-w,P=Math.atan2(m-y,v-g);if(d&&(P+=P>0?-Math.PI:Math.PI),void 0!==f){var I=P-f;if(S=S||0!==I,I+=I>Math.PI?-2*Math.PI:I<-Math.PI?2*Math.PI:0,Math.abs(I)>s)return null}f=P;var T=k/x,D=Fe(g,v,T),M=Fe(y,m,T);p[u]=[D,M,O/2,P,b],o+=O}return S?p:[[p[0][0],p[0][1],p[0][2],p[0][3],r]]}var Cs=i(5),bs=i.n(Cs),Os=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Es=[1/0,1/0,-1/0,-1/0],ks=[1,0,0,1,0,0],Ps=[],Is=[],Ts=[],Ds=[],Ms=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.overlaps=n,o.pixelRatio=i,o.resolution=e,o.alignFill_,o.declutterItems=[],o.instructions=r.instructions,o.coordinates=r.coordinates,o.coordinateCache_={},o.renderedTransform_=[1,0,0,1,0,0],o.hitDetectionInstructions=r.hitDetectionInstructions,o.pixelCoordinates_=null,o.viewRotation_=0,o.fillStates=r.fillStates||{},o.strokeStates=r.strokeStates||{},o.textStates=r.textStates||{},o.widths_={},o}return Os(e,t),e.prototype.disposeInternal=function(){yo.release(this),t.prototype.disposeInternal.call(this)},e.prototype.getTextImage=function(t,e,i,n){var r,o=n+e+t+i+this.pixelRatio;if(!yo.containsKey(o)){var s=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,h=this.textStates[e],l=this.pixelRatio,c=h.scale*l,u=ps[h.textAlign||"center"],f=n&&s.lineWidth?s.lineWidth:0,p=t.split("\n"),d=p.length,_=[],g=function(t,e,i){for(var n=e.length,r=0,o=0;o<n;++o){var s=Eo(t,e[o]);r=Math.max(r,s),i.push(s)}return r}(h.font,p,_),y=Oo(h.font),v=y*d,m=g+f,w=se(Math.ceil((m+2)*c),Math.ceil((v+f)*c));r=w.canvas,yo.set(o,r),1!=c&&w.scale(c,c),w.font=h.font,n&&(w.strokeStyle=s.strokeStyle,w.lineWidth=f,w.lineCap=s.lineCap,w.lineJoin=s.lineJoin,w.miterLimit=s.miterLimit,w.setLineDash&&s.lineDash.length&&(w.setLineDash(s.lineDash),w.lineDashOffset=s.lineDashOffset)),i&&(w.fillStyle=a.fillStyle),w.textBaseline="middle",w.textAlign="center";var x=.5-u,S=u*m+x*f,C=void 0;if(n)for(C=0;C<d;++C)w.strokeText(p[C],S+x*_[C],.5*(f+y)+C*y);if(i)for(C=0;C<d;++C)w.fillText(p[C],S+x*_[C],.5*(f+y)+C*y)}return yo.get(o,this)},e.prototype.replayTextBackground_=function(t,e,i,n,r,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},e.prototype.replayImage_=function(t,e,i,n,r,o,s,a,h,l,c,u,f,p,d,_,g,y){var v=g||y;e-=r*=f,i-=o*=f;var m=d+l>n.width?n.width-l:d,w=a+c>n.height?n.height-c:a,x=_[3]+m*f+_[1],S=_[0]+w*f+_[2],C=e-_[3],b=i-_[0];(v||0!==u)&&(Ps[0]=C,Ds[0]=C,Ps[1]=b,Is[1]=b,Is[0]=C+x,Ts[0]=Is[0],Ts[1]=b+S,Ds[1]=Ts[1]);var O=null;if(0!==u){var E=e+r,k=i+o;O=fn(ks,E,k,1,1,u,-E,-k),un(ks,Ps),un(ks,Is),un(ks,Ts),un(ks,Ds),ti(Math.min(Ps[0],Is[0],Ts[0],Ds[0]),Math.min(Ps[1],Is[1],Ts[1],Ds[1]),Math.max(Ps[0],Is[0],Ts[0],Ds[0]),Math.max(Ps[1],Is[1],Ts[1],Ds[1]),Es)}else ti(C,b,C+x,b+S,Es);var P=t.canvas,I=y?y[2]*f/2:0,T=Es[0]-I<=P.width&&Es[2]+I>=0&&Es[1]-I<=P.height&&Es[3]+I>=0;if(p&&(e=Math.round(e),i=Math.round(i)),s){if(!T&&1==s[4])return;ri(s,Es);var D=T?[t,O?O.slice(0):null,h,n,l,c,m,w,e,i,f]:null;D&&(v&&D.push(g,y,Ps,Is,Ts,Ds),s.push(D))}else T&&(v&&this.replayTextBackground_(t,Ps,Is,Ts,Ds,g,y),To(t,O,h,n,l,c,m,w,e,i,f))},e.prototype.fill_=function(t){if(this.alignFill_){var e=un(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},e.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},e.prototype.renderDeclutter=function(t,e,i,n){if(t&&t.length>5){var r=t[4];if(1==r||r==t.length-5){var o={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(n||(n=new bs.a(9)),!n.collides(o)){n.insert(o);for(var s=5,a=t.length;s<a;++s){var h=t[s],l=h[0],c=l.globalAlpha;c!==i&&(l.globalAlpha=i),h.length>11&&this.replayTextBackground_(h[0],h[13],h[14],h[15],h[16],h[11],h[12]),To.apply(void 0,h),c!==i&&(l.globalAlpha=c)}}t.length=5,ei(t)}}return n},e.prototype.drawTextImageWithPointPlacement_=function(t,e,i,n){var r=this.textStates[e],o=this.getTextImage(t,e,n,i),s=this.strokeStates[i],a=this.pixelRatio,h=ps[r.textAlign||"center"],l=ps[r.textBaseline||"middle"],c=s&&s.lineWidth?s.lineWidth:0;return{label:o,anchorX:h*(o.width/a-2*r.scale)+2*(.5-h)*c,anchorY:l*o.height/a+2*(.5-l)*c}},e.prototype.execute_=function(t,e,i,n,r,o){var s,a,h;this.declutterItems.length=0,this.pixelCoordinates_&&bt(e,this.renderedTransform_)?s=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),s=ki(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),a=this.renderedTransform_,h=e,a[0]=h[0],a[1]=h[1],a[2]=h[2],a[3]=h[3],a[4]=h[4],a[5]=h[5]);for(var l,c,u,f,p,d,_,g,y,v,m,w,x,S,C,b,O,E=0,k=i.length,P=0,I=0,T=0,D=null,M=null,L=this.coordinateCache_,F=this.viewRotation_,R=Math.round(1e12*Math.atan2(-e[1],e[0]))/1e12,A={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:F},j=this.instructions!=i||this.overlaps?0:200;E<k;){var G=i[E];switch(G[0]){case es.BEGIN_GEOMETRY:(C=G[1]).getGeometry()?void 0===o||gi(o,G[3])?++E:E=G[2]+1:E=G[2];break;case es.BEGIN_PATH:I>j&&(this.fill_(t),I=0),T>j&&(t.stroke(),T=0),I||T||(t.beginPath(),f=NaN,p=NaN),++E;break;case es.CIRCLE:var N=s[P=G[1]],W=s[P+1],X=s[P+2]-N,B=s[P+3]-W,Y=Math.sqrt(X*X+B*B);t.moveTo(N+Y,W),t.arc(N,W,Y,0,2*Math.PI,!0),++E;break;case es.CLOSE_PATH:t.closePath(),++E;break;case es.CUSTOM:P=G[1],l=G[2];var q=G[3],z=G[4],V=6==G.length?G[5]:void 0;A.geometry=q,A.feature=C,E in L||(L[E]=[]);var K=L[E];V?V(s,P,l,2,K):(K[0]=s[P],K[1]=s[P+1],K.length=2),z(K,A),++E;break;case es.DRAW_IMAGE:P=G[1],l=G[2],v=G[3],c=G[4],u=G[5],y=r?null:G[6];var U=G[7],H=G[8],Z=G[9],J=G[10],$=G[11],Q=G[12],tt=G[13],et=G[14];if(!v&&G.length>=19){m=G[18],w=G[19],x=G[20],S=G[21];var it=this.drawTextImageWithPointPlacement_(m,w,x,S);v=it.label,G[3]=v;var nt=G[22];c=(it.anchorX-nt)*this.pixelRatio,G[4]=c;var rt=G[23];u=(it.anchorY-rt)*this.pixelRatio,G[5]=u,U=v.height,G[7]=U,et=v.width,G[14]=et}var ot=void 0;G.length>24&&(ot=G[24]);var st=void 0,at=void 0,ht=void 0;G.length>16?(st=G[15],at=G[16],ht=G[17]):(st=go,at=!1,ht=!1),$&&R?Q+=F:$||R||(Q-=F);for(var lt=0,ct=0;P<l;P+=2)if(!(ot&&ot[lt++]<et/this.pixelRatio)){if(y){var ut=Math.floor(ct);y.length<ut+1&&((g=[1/0,1/0,-1/0,-1/0]).push(y[0][4]),y.push(g)),g=y[ut]}this.replayImage_(t,s[P],s[P+1],v,c,u,g,U,H,Z,J,Q,tt,n,et,st,at?D:null,ht?M:null),g&&(ct===Math.floor(ct)&&this.declutterItems.push(this,g,C),ct+=1/g[4])}++E;break;case es.DRAW_CHARS:var ft=G[1],pt=G[2],dt=G[3];g=r?null:G[4];var _t=G[5];S=G[6];var gt=G[7],yt=G[8],vt=G[9];x=G[10];var mt=G[11];m=G[12],w=G[13];var wt=G[14],xt=this.textStates[w],St=xt.font,Ct=xt.scale*yt,Ot=void 0;St in this.widths_?Ot=this.widths_[St]:(Ot={},this.widths_[St]=Ot);var Et=Kn(s,ft,pt,2),kt=Ct*ko(St,m,Ot);if(_t||kt<=Et){var Pt=this.textStates[w].textAlign,It=Ss(s,ft,pt,2,m,(Et-kt)*ps[Pt],gt,Ct,ko,St,Ot);if(It){var Tt=void 0,Dt=void 0,Mt=void 0,Lt=void 0,Ft=void 0;if(x)for(Tt=0,Dt=It.length;Tt<Dt;++Tt)Mt=(Ft=It[Tt])[4],Lt=this.getTextImage(Mt,w,"",x),c=Ft[2]+mt,u=dt*Lt.height+2*(.5-dt)*mt-vt,this.replayImage_(t,Ft[0],Ft[1],Lt,c,u,g,Lt.height,1,0,0,Ft[3],wt,!1,Lt.width,go,null,null);if(S)for(Tt=0,Dt=It.length;Tt<Dt;++Tt)Mt=(Ft=It[Tt])[4],Lt=this.getTextImage(Mt,w,S,""),c=Ft[2],u=dt*Lt.height-vt,this.replayImage_(t,Ft[0],Ft[1],Lt,c,u,g,Lt.height,1,0,0,Ft[3],wt,!1,Lt.width,go,null,null)}}this.declutterItems.push(this,g,C),++E;break;case es.END_GEOMETRY:if(void 0!==r){var Rt=r(C=G[1]);if(Rt)return Rt}++E;break;case es.FILL:j?I++:this.fill_(t),++E;break;case es.MOVE_TO_LINE_TO:for(P=G[1],l=G[2],b=s[P],_=(O=s[P+1])+.5|0,(d=b+.5|0)===f&&_===p||(t.moveTo(b,O),f=d,p=_),P+=2;P<l;P+=2)d=(b=s[P])+.5|0,_=(O=s[P+1])+.5|0,P!=l-2&&d===f&&_===p||(t.lineTo(b,O),f=d,p=_);++E;break;case es.SET_FILL_STYLE:D=G,this.alignFill_=G[2],I&&(this.fill_(t),I=0,T&&(t.stroke(),T=0)),t.fillStyle=G[1],++E;break;case es.SET_STROKE_STYLE:M=G,T&&(t.stroke(),T=0),this.setStrokeStyle_(t,G),++E;break;case es.STROKE:j?T++:t.stroke(),++E;break;default:++E}}I&&this.fill_(t),T&&t.stroke()},e.prototype.execute=function(t,e,i,n){this.viewRotation_=i,this.execute_(t,e,this.instructions,n,void 0,void 0)},e.prototype.executeHitDetection=function(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,e,this.hitDetectionInstructions,!0,n,r)},e}(Wt),Ls=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Fs=[ws,gs,ms,vs,xs,ys],Rs=function(t){function e(e,i,n,r,o,s){var a=t.call(this)||this;return a.maxExtent_=e,a.overlaps_=r,a.pixelRatio_=n,a.resolution_=i,a.renderBuffer_=s,a.executorsByZIndex_={},a.hitDetectionContext_=null,a.hitDetectionTransform_=[1,0,0,1,0,0],a.createExecutors_(o),a}return Ls(e,t),e.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},e.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);var n=t[e];for(var r in n){var o=n[r];i[r]=new Ms(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}},e.prototype.disposeInternal=function(){for(var e in this.executorsByZIndex_){var i=this.executorsByZIndex_[e];for(var n in i)i[n].disposeInternal()}if(this.hitDetectionContext_){var r=this.hitDetectionContext_.canvas;r.width=0,r.height=0}t.prototype.disposeInternal.call(this)},e.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[e],n=0,r=t.length;n<r;++n)if(t[n]in i)return!0;return!1},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o){var s=2*(n=Math.round(n))+1,a=fn(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=se(s,s));var h,l=this.hitDetectionContext_;l.canvas.width!==s||l.canvas.height!==s?(l.canvas.width=s,l.canvas.height=s):l.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(oi(h=[1/0,1/0,-1/0,-1/0],t),Ue(h,e*(this.renderBuffer_+n),h));var c,u=function(t){if(void 0!==As[t])return As[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);var r=t,o=0,s=0;for(;r>=o;)js(i,t+r,t+o),js(i,t+o,t+r),js(i,t-o,t+r),js(i,t-r,t+o),js(i,t-r,t-o),js(i,t-o,t-r),js(i,t+o,t-r),js(i,t+r,t-o),o++,2*((s+=1+2*o)-r)+1>0&&(s+=1-2*(r-=1));return As[t]=i,i}(n);function f(t){for(var e=l.getImageData(0,0,s,s).data,i=0;i<s;i++)for(var n=0;n<s;n++)if(u[i][n]&&e[4*(n*s+i)+3]>0){var a=void 0;return(!o||c!=vs&&c!=xs||-1!==o.indexOf(t))&&(a=r(t)),a||void l.clearRect(0,0,s,s)}}var p,d,_,g,y,v=Object.keys(this.executorsByZIndex_).map(Number);for(v.sort(xt),p=v.length-1;p>=0;--p){var m=v[p].toString();for(_=this.executorsByZIndex_[m],d=Fs.length-1;d>=0;--d)if(void 0!==(g=_[c=Fs[d]])&&(y=g.executeHitDetection(l,a,i,f,h)))return y}},e.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var i=e[0],n=e[1],r=e[2],o=e[3],s=[i,n,i,o,r,o,r,n];return ki(s,0,8,2,t,s),s},e.prototype.isEmpty=function(){return At(this.executorsByZIndex_)},e.prototype.execute=function(t,e,i,n,r,o){var s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(xt),this.maxExtent_&&(t.save(),this.clip(t,e));var a,h,l,c,u,f,p=r||Fs;for(a=0,h=s.length;a<h;++a){var d=s[a].toString();for(u=this.executorsByZIndex_[d],l=0,c=p.length;l<c;++l){var _=p[l];if(void 0!==(f=u[_]))if(!o||_!=vs&&_!=xs)f.execute(t,e,i,n);else{var g=o[d];g?g.push(f,e.slice(0)):o[d]=[f,e.slice(0)]}}}this.maxExtent_&&t.restore()},e}(Wt),As={0:[[!0]]};function js(t,e,i){var n,r=Math.floor(t.length/2);if(e>=r)for(n=r;n<e;n++)t[n][i]=!0;else if(e<r)for(n=e+1;n<r;n++)t[n][i]=!0}var Gs=Rs,Ns=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ws=function(t){function e(e,i,n,r){var o=t.call(this,e)||this;return o.inversePixelTransform=i,o.frameState=n,o.context=r,o}return Ns(e,t),e}(Bt),Xs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bs=function(t){function e(e){var i=t.call(this)||this;return i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=e,i}return Xs(e,t),e.prototype.getFeatures=function(t){return It()},e.prototype.prepareFrame=function(t){return It()},e.prototype.renderFrame=function(t,e){return It()},e.prototype.loadedTileCallback=function(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,r){var o=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,o)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){},e.prototype.getDataAtPixel=function(t,e,i){return It()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===ao&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=ao&&e!=ho&&t.addEventListener(zt,this.boundHandleImageChange_),e==oo&&(t.load(),e=t.getState()),e==ao},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==zr&&t.changed()},e}(Qt),Ys=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qs=function(t){function e(e){var i=t.call(this,e)||this;return i.container=null,i.renderedResolution,i.tempTransform_=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i.createTransformStringCanvas_=se(1,1).canvas,i}return Ys(e,t),e.prototype.useContainer=function(t,e,i){var n,r,o=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===o&&((a=t.firstElementChild)instanceof HTMLCanvasElement&&(r=a.getContext("2d")));if(r&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(n=document.createElement("div")).className=o;var s=n.style;s.position="absolute",s.width="100%",s.height="100%";var a=(r=se()).canvas;n.appendChild(a),(s=a.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=n,this.context=r}},e.prototype.clip=function(t,e,i){var n=e.pixelRatio,r=e.size[0]*n/2,o=e.size[1]*n/2,s=e.viewState.rotation,a=pi(i),h=di(i),l=ci(i),c=li(i);un(e.coordinateToPixelTransform,a),un(e.coordinateToPixelTransform,h),un(e.coordinateToPixelTransform,l),un(e.coordinateToPixelTransform,c),t.save(),Po(t,-s,r,o),t.beginPath(),t.moveTo(a[0]*n,a[1]*n),t.lineTo(h[0]*n,h[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(c[0]*n,c[1]*n),t.clip(),Po(t,s,r,o)},e.prototype.clipUnrotated=function(t,e,i){var n=pi(i),r=di(i),o=ci(i),s=li(i);un(e.coordinateToPixelTransform,n),un(e.coordinateToPixelTransform,r),un(e.coordinateToPixelTransform,o),un(e.coordinateToPixelTransform,s);var a=this.inversePixelTransform;un(a,n),un(a,r),un(a,o),un(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var r=new Ws(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(Xr,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(Br,t,e)},e.prototype.getRenderTransform=function(t,e,i,n,r,o,s){var a=r/2,h=o/2,l=n/e,c=-l,u=-t[0]+s,f=-t[1];return fn(this.tempTransform_,a,h,l,c,-i,u,f)},e.prototype.getDataAtPixel=function(t,e,i){var n,r=un(this.inversePixelTransform,t.slice()),o=this.context;try{n=o.getImageData(Math.round(r[0]),Math.round(r[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:n}return 0===n[3]?null:n},e.prototype.createTransformString=function(t){return this.createTransformStringCanvas_.style.transform=dn(t),this.createTransformStringCanvas_.style.transform},e}(Bs),zs={Point:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=ao)return;var o=t.getBuilder(i.getZIndex(),vs);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),xs);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},LineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getBuilder(i.getZIndex(),ms);o.setFillStrokeStyle(null,r),o.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),xs);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getBuilder(i.getZIndex(),ws);s.setFillStrokeStyle(r,o),s.drawPolygon(e,n)}var a=i.getText();if(a){var h=t.getBuilder(i.getZIndex(),xs);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,n)}},MultiPoint:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=ao)return;var o=t.getBuilder(i.getZIndex(),vs);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),xs);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getBuilder(i.getZIndex(),ms);o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getBuilder(i.getZIndex(),xs);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(o||r){var s=t.getBuilder(i.getZIndex(),ws);s.setFillStrokeStyle(r,o),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var h=t.getBuilder(i.getZIndex(),xs);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var r,o,s=e.getGeometriesArray();for(r=0,o=s.length;r<o;++r){(0,zs[s[r].getType()])(t,s[r],i,n)}},Circle:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getBuilder(i.getZIndex(),gs);s.setFillStrokeStyle(r,o),s.drawCircle(e,n)}var a=i.getText();if(a){var h=t.getBuilder(i.getZIndex(),xs);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,n)}}};function Vs(t,e){return parseInt(Dt(t),10)-parseInt(Dt(e),10)}function Ks(t,e){return.5*t/e}function Us(t,e,i,n,r,o){var s=!1,a=i.getImage();if(a){var h=a.getImageState();h==ao||h==ho?a.unlistenImageChange(r):(h==oo&&a.load(),h=a.getImageState(),a.listenImageChange(r),s=!0)}return function(t,e,i,n,r){var o=i.getGeometryFunction()(e);if(!o)return;var s=o.simplifyTransformed(n,r);if(i.getRenderer())!function t(e,i,n,r){if(i.getType()==Oi){for(var o=i.getGeometries(),s=0,a=o.length;s<a;++s)t(e,o[s],n,r);return}e.getBuilder(n.getZIndex(),ys).drawCustom(i,r,n.getRenderer())}(t,s,i,e);else{(0,zs[s.getType()])(t,s,i,e)}}(t,e,i,n,o),s}var Hs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zs=function(t){function e(e,i,n,r,o,s,a){var h=t.call(this)||this;return h.context_=e,h.pixelRatio_=i,h.extent_=n,h.transform_=r,h.viewRotation_=o,h.squaredTolerance_=s,h.userTransform_=a,h.contextFillState_=null,h.contextStrokeState_=null,h.contextTextState_=null,h.fillState_=null,h.strokeState_=null,h.image_=null,h.imageAnchorX_=0,h.imageAnchorY_=0,h.imageHeight_=0,h.imageOpacity_=0,h.imageOriginX_=0,h.imageOriginY_=0,h.imageRotateWithView_=!1,h.imageRotation_=0,h.imageScale_=0,h.imageWidth_=0,h.text_="",h.textOffsetX_=0,h.textOffsetY_=0,h.textRotateWithView_=!1,h.textRotation_=0,h.textScale_=0,h.textFillState_=null,h.textStrokeState_=null,h.textState_=null,h.pixelCoordinates_=[],h.tmpLocalTransform_=[1,0,0,1,0,0],h}return Hs(e,t),e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var r=ki(t,e,i,2,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var h=this.imageRotation_;this.imageRotateWithView_&&(h+=this.viewRotation_);for(var l=0,c=r.length;l<c;l+=2){var u=r[l]-this.imageAnchorX_,f=r[l+1]-this.imageAnchorY_;if(0!==h||1!=this.imageScale_){var p=u+this.imageAnchorX_,d=f+this.imageAnchorY_;fn(s,p,d,this.imageScale_,this.imageScale_,h,-p,-d),o.setTransform.apply(o,s)}o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,u,f,this.imageWidth_,this.imageHeight_)}0===h&&1==this.imageScale_||o.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(o.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=ki(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a=r[e]+this.textOffsetX_,h=r[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_){var l=fn(this.tmpLocalTransform_,a,h,this.textScale_,this.textScale_,s,-a,-h);o.setTransform.apply(o,l)}this.textStrokeState_&&o.strokeText(this.text_,a,h),this.textFillState_&&o.fillText(this.text_,a,h)}0===s&&1==this.textScale_||o.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,n,r){var o=this.context_,s=ki(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;r&&(a-=2);for(var h=2;h<a;h+=2)o.lineTo(s[h],s[h+1]);return r&&o.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e},e.prototype.drawCircle=function(t){if(gi(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var r=t.getStride();return ki(n,0,n.length,r,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case vi:this.drawPoint(t);break;case mi:this.drawLineString(t);break;case xi:this.drawPolygon(t);break;case Si:this.drawMultiPoint(t);break;case Ci:this.drawMultiLineString(t);break;case bi:this.drawMultiPolygon(t);break;case Oi:this.drawGeometryCollection(t);break;case Ei:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&gi(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),gi(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(gi(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),r=0,o=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,h=o.length;a<h;++a)r=this.moveToLineTo_(n,r,o[a],s,!1);i.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),gi(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),gi(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,r=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=r.length;s<a;++s){var h=r[s];n=this.drawRings_(i,n,h,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(bt(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:"center";i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:no(i||"#000")}}else this.fillState_=null;if(e){var n=e.getColor(),r=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),h=e.getWidth(),l=e.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:"round",lineDash:o||_o,lineDashOffset:s||0,lineJoin:void 0!==a?a:"round",lineWidth:this.pixelRatio_*(void 0!==h?h:1),miterLimit:void 0!==l?l:10,strokeStyle:no(n||"#000")}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),n=t.getOrigin(),r=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=r[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=r[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:no(i||"#000")}}else this.textFillState_=null;var n=t.getStroke();if(n){var r=n.getColor(),o=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),h=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:"round",lineDash:s||_o,lineDashOffset:a||0,lineJoin:void 0!==h?h:"round",lineWidth:void 0!==l?l:1,miterLimit:void 0!==c?c:10,strokeStyle:no(r||"#000")}}else this.textStrokeState_=null;var u=t.getFont(),f=t.getOffsetX(),p=t.getOffsetY(),d=t.getRotateWithView(),_=t.getRotation(),g=t.getScale(),y=t.getText(),v=t.getTextAlign(),m=t.getTextBaseline();this.textState_={font:void 0!==u?u:"10px sans-serif",textAlign:void 0!==v?v:"center",textBaseline:void 0!==m?m:"middle"},this.text_=void 0!==y?y:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0!==_?_:0,this.textScale_=this.pixelRatio_*(void 0!==g?g:1)}else this.text_=""},e}(Ho),Js="fraction",$s="pixels",Qs=function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},t.prototype.get=function(t,e,i){var n=ta(t,e,i);return n in this.cache_?this.cache_[n]:null},t.prototype.set=function(t,e,i,n){var r=ta(t,e,i);this.cache_[r]=n,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}();function ta(t,e,i){return e+":"+t+":"+(i?function(t){return"string"==typeof t?t:io(t)}(i):"null")}var ea=new Qs,ia=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),na=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.extent=e,o.pixelRatio_=n,o.resolution=i,o.state=r,o}return ia(e,t),e.prototype.changed=function(){this.dispatchEvent(zt)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return It()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){It()},e}(qt),ra=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function oa(t,e,i){var n=t;if(n.src&&je){var r=n.decode(),o=!0;return r.then((function(){o&&e()})).catch((function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():i())})),function(){o=!1}}var s=[Gt(n,Zt,e),Gt(n,Vt,i)];return function(){s.forEach(Nt)}}!function(t){function e(e,i,n,r,o,s){var a=t.call(this,e,i,n,oo)||this;return a.src_=r,a.image_=new Image,null!==o&&(a.image_.crossOrigin=o),a.unlisten_=null,a.state=oo,a.imageLoadFunction_=s,a}ra(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=ho,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=fi(this.extent)/this.image_.height),this.state=ao,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=oo&&this.state!=ho||(this.state=so,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=oa(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}(na);var sa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),aa=function(t){function e(e,i,n,r,o,s){var a=t.call(this)||this;return a.hitDetectionImage_=null,a.image_=e||new Image,null!==r&&(a.image_.crossOrigin=r),a.canvas_=s?document.createElement("canvas"):null,a.color_=s,a.unlisten_=null,a.imageState_=o,a.size_=n,a.src_=i,a.tainted_,a}return sa(e,t),e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===ao){this.tainted_=!1;var t=se(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(zt)},e.prototype.handleImageError_=function(){this.imageState_=ho,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=ao,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],n=se(e,i);n.fillRect(0,0,e,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==oo){this.imageState_=so;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=oa(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(){if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),i=e.data,n=this.color_[0]/255,r=this.color_[1]/255,o=this.color_[2]/255,s=0,a=i.length;s<a;s+=4)i[s]*=n,i[s+1]*=r,i[s+2]*=o;t.putImageData(e,0,0)}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(qt);var ha="bottom-left",la="bottom-right",ca="top-left",ua="top-right",fa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pa=function(t){function e(e){var i=this,n=e||{},r=void 0!==n.opacity?n.opacity:1,o=void 0!==n.rotation?n.rotation:0,s=void 0!==n.scale?n.scale:1,a=void 0!==n.rotateWithView&&n.rotateWithView;(i=t.call(this,{opacity:r,rotation:o,scale:s,rotateWithView:a})||this).anchor_=void 0!==n.anchor?n.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==n.anchorOrigin?n.anchorOrigin:ca,i.anchorXUnits_=void 0!==n.anchorXUnits?n.anchorXUnits:Js,i.anchorYUnits_=void 0!==n.anchorYUnits?n.anchorYUnits:Js,i.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null;var h=void 0!==n.img?n.img:null,l=void 0!==n.imgSize?n.imgSize:null,c=n.src;_e(!(void 0!==c&&h),4),_e(!h||h&&l,5),void 0!==c&&0!==c.length||!h||(c=h.src||Dt(h)),_e(void 0!==c&&c.length>0,6);var u=void 0!==n.src?oo:ao;return i.color_=void 0!==n.color?to(n.color):null,i.iconImage_=function(t,e,i,n,r,o){var s=ea.get(e,n,o);return s||(s=new aa(t,e,i,n,r,o),ea.set(e,n,o,s)),s}(h,c,l,i.crossOrigin_,u,i.color_),i.offset_=void 0!==n.offset?n.offset:[0,0],i.offsetOrigin_=void 0!==n.offsetOrigin?n.offsetOrigin:ca,i.origin_=null,i.size_=void 0!==n.size?n.size:null,i}return fa(e,t),e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==Js||this.anchorYUnits_==Js){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==Js&&(t[0]*=e[0]),this.anchorYUnits_==Js&&(t[1]*=e[1])}if(this.anchorOrigin_!=ca){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=ua&&this.anchorOrigin_!=la||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=ha&&this.anchorOrigin_!=la||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=ca){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),this.offsetOrigin_!=ua&&this.offsetOrigin_!=la||(t[0]=i[0]-e[0]-t[0]),this.offsetOrigin_!=ha&&this.offsetOrigin_!=la||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(zt,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(zt,t)},e}(Do);function da(t,e,i){var n=[];if(i){var r=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*i.width),o=i.data[r],s=i.data[r+1],a=i.data[r+2]+256*(s+256*o),h=Math.ceil(16777216/e.length);a%h==0&&n.push(e[a/h])}return n}var _a=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ga=function(t){function e(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=[1/0,1/0,-1/0,-1/0],i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i}return _a(e,t),e.prototype.useContainer=function(e,i,n){n<1&&(e=null),t.prototype.useContainer.call(this,e,i,n)},e.prototype.renderFrame=function(t,e){var i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,i){cn(t,e,0,0,i,0,0)}(this.pixelTransform,1/i,1/i),pn(this.inversePixelTransform,this.pixelTransform);var r=dn(this.pixelTransform);this.useContainer(e,r,n.opacity);var o=this.context,s=o.canvas,a=this.replayGroup_;if(!a||a.isEmpty())return!this.containerReused&&s.width>0&&(s.width=0),this.container;var h=Math.round(t.size[0]*i),l=Math.round(t.size[1]*i);s.width!=h||s.height!=l?(s.width=h,s.height=l,s.style.transform!==r&&(s.style.transform=r)):this.containerReused||o.clearRect(0,0,h,l),this.preRender(o,t);var c=t.extent,u=t.viewState,f=u.center,p=u.resolution,d=u.projection,_=u.rotation,g=d.getExtent(),y=this.getLayer().getSource(),v=!1;if(n.extent){var m=function(t,e){return hn?rn(t,hn,e):t}(n.extent,d);(v=!Ze(m,t.extent)&&gi(m,t.extent))&&this.clip(o,t,m)}var w=t.viewHints,x=!(w[Ko]||w[Uo]),S=this.getRenderTransform(f,p,_,i,h,l,0),C=this.getLayer().getDeclutter()?{}:null;if(a.execute(o,S,_,x,void 0,C),y.getWrapX()&&d.canWrapX()&&!Ze(g,c)){for(var b=c[0],O=_i(g),E=0,k=void 0;b<g[0];){k=O*--E;var P=this.getRenderTransform(f,p,_,i,h,l,k);a.execute(o,P,_,x,void 0,C),b+=O}for(E=0,b=c[2];b>g[2];){k=O*++E;var I=this.getRenderTransform(f,p,_,i,h,l,k);a.execute(o,I,_,x,void 0,C),b-=O}}if(C){var T=t.viewHints;!function(t,e,i,n,r,o){for(var s=Object.keys(t).map(Number).sort(xt),a=0,h=s.length;a<h;++a)for(var l=t[s[a].toString()],c=void 0,u=0,f=l.length;u<f;){var p=l[u++];p!==c&&(c=p,o.push({items:p.declutterItems,opacity:n}));var d=l[u++];p.execute(e,d,i,r)}}(C,o,_,1,!(T[Ko]||T[Uo]),t.declutterItems)}v&&o.restore(),this.postRender(o,t);var D=n.opacity,M=this.container;return D!==parseFloat(M.style.opacity)&&(M.style.opacity=1===D?"":D),this.container},e.prototype.getFeatures=function(t){return new Promise(function(e,i){this.hitDetectionImageData_||this.animatingOrInteracting_?e(da(t,this.renderedFeatures_,this.hitDetectionImageData_)):requestAnimationFrame(function(){var i=[this.context.canvas.width,this.context.canvas.height];un(this.pixelTransform,i);var n=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,s=this.renderedProjection_,a=this.renderedExtent_,h=this.getLayer(),l=[],c=i[0]/2,u=i[1]/2;l.push(this.getRenderTransform(n,r,o,.5,c,u,0).slice());var f=h.getSource(),p=s.getExtent();if(f.getWrapX()&&s.canWrapX()&&!Ze(p,a)){for(var d=a[0],_=_i(p),g=0,y=void 0;d<p[0];)y=_*--g,l.push(this.getRenderTransform(n,r,o,.5,c,u,y).slice()),d+=_;for(g=0,d=a[2];d>p[2];)y=_*++g,l.push(this.getRenderTransform(n,r,o,.5,c,u,y).slice()),d-=_}this.hitDetectionImageData_=function(t,e,i,n,r,o,s){var a=se(t[0]/2,t[1]/2);a.imageSmoothingEnabled=!1;for(var h=a.canvas,l=new Zs(a,.5,r,null,s),c=i.length,u=Math.ceil(16777216/c),f={},p=0;p<c;++p){var d=i[p],_=d.getStyleFunction()||n;if(n){var g=_(d,o);Array.isArray(g)||(g=[g]);for(var y="#"+("000000"+(p*u).toString(16)).slice(-6),v=0,m=g.length;v<m;++v){var w=g[v],x=w.clone(),S=x.getFill();S&&S.setColor(y);var C=x.getStroke();C&&C.setColor(y),x.setText(void 0);var b=w.getImage();if(b){var O=b.getImageSize(),E=document.createElement("canvas");E.width=O[0],E.height=O[1];var k=E.getContext("2d",{alpha:!1});k.fillStyle=y;var P=k.canvas;k.fillRect(0,0,P.width,P.height),se(O?O[0]:P.width,O?O[1]:P.height).drawImage(P,0,0),x.setImage(new pa({img:P,imgSize:O,anchor:b.getAnchor(),anchorXUnits:$s,anchorYUnits:$s,offset:b.getOrigin(),size:b.getSize(),opacity:b.getOpacity(),scale:b.getScale(),rotation:b.getRotation(),rotateWithView:b.getRotateWithView()}))}var I=Number(x.getZIndex());(L=f[I])||(L={},f[I]=L,L[xi]=[],L[Ei]=[],L[mi]=[],L[vi]=[]);var T=x.getGeometryFunction()(d);T&&gi(r,T.getExtent())&&L[T.getType().replace("Multi","")].push(T,x)}}}for(var D=Object.keys(f).map(Number).sort(xt),M=(p=0,D.length);p<M;++p){var L=f[D[p]];for(var F in L){var R=L[F];for(v=0,m=R.length;v<m;v+=2){l.setStyle(R[v+1]);for(var A=0,j=e.length;A<j;++A)l.setTransform(e[A]),l.drawGeometry(R[v])}}}return a.getImageData(0,0,h.width,h.height)}(i,l,this.renderedFeatures_,h.getStyleFunction(),a,r,o),e(da(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){if(this.replayGroup_){var o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),h={};return this.replayGroup_.forEachFeatureAtCoordinate(t,o,s,i,(function(t){var e=Dt(t);if(!(e in h))return h[e]=!0,n(t,a)}),a.getDeclutter()?r:null)}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var e=this.getLayer(),i=e.getSource(),n=t.viewHints[Ko],r=t.viewHints[Uo],o=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(!this.dirty_&&!o&&n||!s&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var a=t.extent,h=t.viewState,l=h.projection,c=h.resolution,u=t.pixelRatio,f=e.getRevision(),p=e.getRenderBuffer(),d=e.getRenderOrder();void 0===d&&(d=Vs);var _=h.center.slice(),g=Ue(a,p*c),y=h.projection.getExtent();if(i.getWrapX()&&h.projection.canWrapX()&&!Ze(y,t.extent)){var v=_i(y),m=Math.max(_i(g)/2,v);g[0]=y[0]-m,g[2]=y[2]+m;var w=Math.floor((_[0]-y[0])/v);_[0]-=w*v}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==d&&Ze(this.renderedExtent_,g))return this.replayGroupChanged=!1,!0;this.replayGroup_&&this.replayGroup_.dispose(),this.replayGroup_=null,this.dirty_=!1;var x,S=new _s(Ks(c,u),g,c,u,e.getDeclutter()),C=hn;C?(i.loadFeatures(ln(g,l),c,C),x=en(C,l)):i.loadFeatures(g,c,l);var b=function(t,e){var i=Ks(t,e);return i*i}(c,u),O=function(t){var i,n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,c)),i){var r=this.renderFeature(t,b,i,S,x);this.dirty_=this.dirty_||r}}.bind(this),E=ln(g,l),k=i.getFeaturesInExtent(E);d&&k.sort(d);for(var P=0,I=k.length;P<I;++P)O(k[P]);this.renderedFeatures_=k;var T=S.finish(),D=new Gs(g,c,u,i.getOverlaps(),T,e.getRenderBuffer());return this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=d,this.renderedExtent_=g,this.renderedRotation_=h.rotation,this.renderedCenter_=_,this.renderedProjection_=l,this.replayGroup_=D,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,n,r){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var s=0,a=i.length;s<a;++s)o=Us(n,t,i[s],e,this.boundHandleStyleImageChange_,r)||o;else o=Us(n,t,i,e,this.boundHandleStyleImageChange_,r);return o},e}(qs),ya=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),va=function(t){function e(e){return t.call(this,e)||this}return ya(e,t),e.prototype.createRenderer=function(){return new ga(this)},e}(Vo),ma="add",wa="remove",xa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sa="length",Ca=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.element=i,r.index=n,r}return xa(e,t),e}(Bt),ba=function(t){function e(e,i){var n=t.call(this)||this,r=i||{};if(n.unique_=!!r.unique,n.array_=e||[],n.unique_)for(var o=0,s=n.array_.length;o<s;++o)n.assertUnique_(n.array_[o],o);return n.updateLength_(),n}return xa(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Sa)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ca(ma,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ca(wa,e,t)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ca(wa,n,t)),this.dispatchEvent(new Ca(ma,e,t))}else{for(var r=i;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Sa,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new de(58)},e}(oe),Oa="arraybuffer",Ea="json",ka="text",Pa="xml",Ia=!1;function Ta(t,e){return function(t,e,i,n){return function(r,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,o,s):t,!0),e.getType()==Oa&&(a.responseType="arraybuffer"),a.withCredentials=Ia,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var o=e.getType(),h=void 0;o==Ea||o==ka?h=a.responseText:o==Pa?(h=a.responseXML)||(h=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==Oa&&(h=a.response),h?i.call(this,e.readFeatures(h,{extent:r,featureProjection:s}),e.readProjection(h)):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}(t,e,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),kt)}function Da(t,e){return[[-1/0,-1/0,1/0,1/0]]}var Ma=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function La(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Fa=function(t){function e(e){var i=t.call(this)||this;return i.projection_=Qi(e.projection),i.attributions_=La(e.attributions),i.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,i.loading=!1,i.state_=void 0!==e.state?e.state:zr,i.wrapX_=void 0!==e.wrapX&&e.wrapX,i}return Ma(e,t),e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return It()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=La(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(oe),Ra="addfeature",Aa="changefeature",ja="clear",Ga="removefeature",Na=function(){function t(t){this.rbush_=new bs.a(t),this.items_={}}return t.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Dt(e)]=i},t.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,r=e.length;n<r;n++){var o=t[n],s=e[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[n]=a,this.items_[Dt(s)]=a}this.rbush_.load(i)},t.prototype.remove=function(t){var e=Dt(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},t.prototype.update=function(t,e){var i=this.items_[Dt(e)];ni([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},t.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},t.prototype.forEach_=function(t,e){for(var i,n=0,r=t.length;n<r;n++)if(i=e(t[n]))return i;return i},t.prototype.isEmpty=function(){return At(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return ti(e.minX,e.minY,e.maxX,e.maxY,t)},t.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},t}(),Wa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xa=function(t){function e(e,i){var n=t.call(this,e)||this;return n.feature=i,n}return Wa(e,t),e}(Bt),Ba=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{attributions:n.attributions,projection:void 0,state:zr,wrapX:void 0===n.wrapX||n.wrapX})||this).loader_=kt,i.format_=n.format,i.overlaps_=null==n.overlaps||n.overlaps,i.url_=n.url,void 0!==n.loader?i.loader_=n.loader:void 0!==i.url_&&(_e(i.format_,7),i.loader_=Ta(i.url_,i.format_)),i.strategy_=void 0!==n.strategy?n.strategy:Da;var r,o,s=void 0===n.useSpatialIndex||n.useSpatialIndex;return i.featuresRtree_=s?new Na:null,i.loadedExtentsRtree_=new Na,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(n.features)?o=n.features:n.features&&(o=(r=n.features).getArray()),s||void 0!==r||(r=new ba(o)),void 0!==o&&i.addFeaturesInternal(o),void 0!==r&&i.bindFeaturesCollection_(r),i}return Wa(e,t),e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=Dt(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Xa(Ra,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[jt(e,zt,this.handleFeatureChange_,this),jt(e,Mt,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&(_e(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],r=0,o=t.length;r<o;r++){var s=Dt(h=t[r]);this.addToIndex_(s,h)&&i.push(h)}r=0;for(var a=i.length;r<a;r++){var h;s=Dt(h=i[r]);this.setupChangeEvents_(s,h);var l=h.getGeometry();if(l){var c=l.getExtent();e.push(c),n.push(h)}else this.nullGeometryFeatures_[s]=h}this.featuresRtree_&&this.featuresRtree_.load(e,n);r=0;for(var u=i.length;r<u;r++)this.dispatchEvent(new Xa(Ra,i[r]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;this.addEventListener(Ra,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(Ga,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(ma,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(wa,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(Nt)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var n=new Xa(ja);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),At(this.nullGeometryFeatures_)||Ct(t,Rt(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],h=e||Ot;return this.featuresRtree_.forEachInExtent(a,(function(t){if(h(t)){var e=t.getGeometry(),l=s;if((s=e.closestPointXY(i,n,o,s))<l){r=t;var c=Math.sqrt(s);a[0]=i-c,a[1]=n-c,a[2]=i+c,a[3]=n+c}}})),r},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=Dt(e),n=e.getGeometry();if(n){var r=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var o=e.getId();if(void 0!==o){var s=o.toString();this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Xa(Aa,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Dt(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&At(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this.loadedExtentsRtree_,r=this.strategy_(t,e);this.loading=!1;for(var o=function(t,o){var a=r[t];n.forEachInExtent(a,(function(t){return Ze(t.extent,a)}))||(s.loader_.call(s,a,e,i),n.insert(a,{extent:a.slice()}),s.loading=s.loader_!==kt)},s=this,a=0,h=r.length;a<h;++a)o(a)},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(ni(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=Dt(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=Dt(t);this.featureChangeKeys_[e].forEach(Nt),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Xa(Ga,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){_e(this.format_,7),this.setLoader(Ta(t,this.format_))},e}(Fa),Ya=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qa="Point",za="LineString",Va="Polygon",Ka="Circle",Ua="drawstart",Ha="drawend",Za=function(t){function e(e,i){var n=t.call(this,e)||this;return n.feature=i,n}return Ya(e,t),e}(Bt);var Ja=function(t){function e(e){var i=this,n=e;n.stopDown||(n.stopDown=Et),(i=t.call(this,n)||this).shouldHandle_=!1,i.downPx_=null,i.downTimeout_,i.lastDragTime_,i.freehand_=!1,i.source_=e.source?e.source:null,i.features_=e.features?e.features:null,i.snapTolerance_=e.snapTolerance?e.snapTolerance:12,i.type_=e.type,i.mode_=function(t){var e;t===vi||t===Si?e=qa:t===mi||t===Ci?e=za:t===xi||t===bi?e=Va:t===Ei&&(e=Ka);return(e)}(i.type_),i.stopClick_=!!e.stopClick,i.minPoints_=e.minPoints?e.minPoints:i.mode_===Va?3:2,i.maxPoints_=e.maxPoints?e.maxPoints:1/0,i.finishCondition_=e.finishCondition?e.finishCondition:Ot;var r,o=e.geometryFunction;if(!o)if(i.type_===Ei)o=function(t,e){var i=e||new Tn([NaN,NaN]),n=Re(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(n)),i};else{var s,a=i.mode_;a===qa?s=rr:a===za?s=tr:a===Va&&(s=mr),o=function(t,e){var i=e;return i?a===Va?t[0].length?i.setCoordinates([t[0].concat([t[0][0]])]):i.setCoordinates([]):i.setCoordinates(t):i=new s(t),i}}return i.geometryFunction_=o,i.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,i.overlay_=new va({source:new Ba({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:(r=Xo(),function(t,e){return r[t.getGeometry().getType()]}),updateWhileInteracting:!0}),i.geometryName_=e.geometryName,i.condition_=e.condition?e.condition:Ne,i.freehandCondition_,e.freehand?i.freehandCondition_=Ge:i.freehandCondition_=e.freehandCondition?e.freehandCondition:We,i.addEventListener(re(Or),i.updateState_),i}return Ya(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===Ut&&e.preventDefault(),this.freehand_=this.mode_!==qa&&this.freehandCondition_(e);var i=e.type===we,n=!0;!this.freehand_&&this.lastDragTime_&&e.type===me&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===me&&null!==this.sketchFeature_?(this.addToDrawing_(e),n=!1):this.freehand_&&e.type===xe?n=!1:i?(n=e.type===we)&&this.freehand_?n=this.handlePointerMove_(e):("mouse"==e.pointerEvent.pointerType||e.type===me&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===ve&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Pe(we,t.map,t.pointerEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)},e.prototype.handleUpEvent=function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var i=this.mode_===Ka;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===qa&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e},e.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,n=e[0]-i[0],r=e[1]-i[1],o=n*n+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,n=[this.finishCoordinate_];if(this.mode_===za)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===Va){var r=this.sketchCoords_;i=r[0].length>this.minPoints_,n=[r[0][0],r[0][r[0].length-2]]}if(i)for(var o=t.map,s=0,a=n.length;s<a;s++){var h=n[s],l=o.getPixelFromCoordinate(h),c=t.pixel,u=c[0]-l[0],f=c[1]-l[1],p=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(u*u+f*f)<=p){this.finishCoordinate_=h;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new ye(new rr(e)),this.updateSketchFeatures_())},e.prototype.startDrawing_=function(t){var e=t.coordinate;this.finishCoordinate_=e,this.mode_===qa?this.sketchCoords_=e.slice():this.mode_===Va?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ye(new tr(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new ye,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new Za(Ua,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,i,n,r=t.coordinate,o=this.sketchFeature_.getGeometry();(this.mode_===qa?i=this.sketchCoords_:this.mode_===Va?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(r=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=r[0],i[1]=r[1],this.geometryFunction_(this.sketchCoords_,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(r);if(o.getType()==xi&&this.mode_!==Va){this.sketchLine_||(this.sketchLine_=new ye);var s=o.getLinearRing(0);(n=this.sketchLine_.getGeometry())?(n.setFlatCoordinates(s.getLayout(),s.getFlatCoordinates()),n.changed()):(n=new tr(s.getFlatCoordinates(),s.getLayout()),this.sketchLine_.setGeometry(n))}else this.sketchLineCoords_&&(n=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,n=t.coordinate,r=this.sketchFeature_.getGeometry();this.mode_===za?(this.finishCoordinate_=n.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),this.geometryFunction_(i,r)):this.mode_===Va&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,r)),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry();this.mode_===za?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e),t.length>=2&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===Va&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e)),0===t.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry();this.mode_===za?(e.pop(),this.geometryFunction_(e,i)):this.mode_===Va&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===Si?t.setGeometry(new sr([e])):this.type_===Ci?t.setGeometry(new ir([e])):this.type_===bi&&t.setGeometry(new br([e])),this.dispatchEvent(new Za(Ha,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new Za(Ua,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},e}(Ir),$a=i(1),Qa=i.n($a),th={create:function(t,e){var i;if(e=e||{},"TEXT"===t)i=document.createTextNode(e.html||""),e.parent&&e.parent.appendChild(i);else for(var n in i=document.createElement(t),/button/i.test(t)&&i.setAttribute("type","button"),e)switch(n){case"className":e.className&&e.className.trim&&i.setAttribute("class",e.className.trim());break;case"html":e.html instanceof Element?i.appendChild(e.html):void 0!==e.html&&(i.innerHTML=e.html);break;case"parent":e.parent.appendChild(i);break;case"style":this.setStyle(i,e.style);break;case"change":case"click":th.addListener(i,n,e[n]);break;case"on":for(var r in e.on)th.addListener(i,r,e.on[r]);break;case"checked":i.checked=!!e.checked;break;default:i.setAttribute(n,e[n])}return i},setHTML:function(t,e){e instanceof Element?t.appendChild(e):void 0!==e&&(t.innerHTML=e)},appendText:function(t,e){t.appendChild(document.createTextNode(e||""))},addListener:function(t,e,i){"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){t.addEventListener(e,i)}))},removeListener:function(t,e,i){"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){t.removeEventListener(e,i)}))},show:function(t){t.style.display=""},hide:function(t){t.style.display="none"},hidden:function(t){return"none"===th.getStyle(t,"display")},toggle:function(t){t.style.display="none"===t.style.display?"":"none"},setStyle:function(t,e){for(var i in e)switch(i){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":"number"==typeof e[i]?t.style[i]=e[i]+"px":t.style[i]=e[i];break;default:t.style[i]=e[i]}},getStyle:function(t,e){var i,n=(t.ownerDocument||document).defaultView;if(n&&n.getComputedStyle)e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),i=n.getComputedStyle(t,null).getPropertyValue(e);else if(t.currentStyle&&(e=e.replace(/-(\w)/g,(function(t,e){return e.toUpperCase()})),i=t.currentStyle[e],/^\d+(em|pt|%|ex)?$/i.test(i)))return function(e){var i=t.style.left,n=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft+"px",t.style.left=i,t.runtimeStyle.left=n,e}(i);return/px$/.test(i)?parseInt(i):i},outerHeight:function(t){return t.offsetHeight+th.getStyle(t,"marginBottom")},outerWidth:function(t){return t.offsetWidth+th.getStyle(t,"marginLeft")},offsetRect:function(t){var e=t.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:e.height||e.bottom-e.top,width:e.widtth||e.right-e.left}},scrollDiv:function(t,e){var i,n=!1,r=0,o=0,s="function"==typeof e.onmove?e.onmove:function(){},a=e.vertical?"pageY":"pageX",h=e.vertical?"scrollTop":"scrollLeft",l=!1;t.querySelectorAll("img").forEach((function(t){t.ondragstart=function(){return!1}})),th.addListener(t,["mousedown"],(function(e){l=!1,n=e[a],o=new Date,t.classList.add("ol-move")})),th.addListener(window,["mousemove"],(function(e){if(l=!0,!1!==n){var c=n-e[a];t[h]+=c,(i=new Date)-o&&(r=(r+c/(i-o))/2),n=e[a],o=i,c&&s(!0)}else s(!1)})),th.addListener(window,["mouseup"],(function(e){l?setTimeout((function(){t.classList.remove("ol-move")})):t.classList.remove("ol-move"),l=!1,(o=new Date-o)>100?r=0:o>0&&(r=((r||0)+(n-e[a])/o)/2),t[h]+=100*r,n=!1,r=0,o=0})),e.mousewheel&&!t.classList.contains("ol-touch")&&th.addListener(t,["mousewheel","DOMMouseScroll","onmousewheel"],(function(e){var i=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));return t.classList.add("ol-move"),t[h]-=30*i,t.classList.remove("ol-move"),!1}))},dispatchEvent:function(t,e){var i;try{i=new CustomEvent(t)}catch(e){(i=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,{})}e.dispatchEvent(i)}},eh=th,ih=function(t){t=t||{};var e=document.createElement("div");e.className=(t.className||"")+" ol-button ol-unselectable ol-control";var i=this,n=this.button_=document.createElement(/ol-text-button/.test(t.className)?"div":"button");n.type="button",t.title&&(n.title=t.title),t.html instanceof Element?n.appendChild(t.html):n.innerHTML=t.html||"";var r=function(e){e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),t.handleClick&&t.handleClick.call(i,e)};n.addEventListener("click",r),n.addEventListener("touchstart",r),e.appendChild(n),!t.title&&n.firstElementChild&&(n.title=n.firstElementChild.title),le.call(this,{element:e,target:t.target}),t.title&&this.set("title",t.title),t.title&&this.set("title",t.title),t.name&&this.set("name",t.name)};wt(ih,le),ih.prototype.setVisible=function(t){t?eh.show(this.element):eh.hide(this.element)},ih.prototype.setTitle=function(t){this.button_.setAttribute("title",t)},ih.prototype.setHtml=function(t){eh.setHTML(this.button_,t)},ih.prototype.getButtonElement=function(){return this.button_};var nh=ih,rh=function(t){t=t||{};var e=this;this.interaction_=t.interaction,this.interaction_&&(this.interaction_.setActive(t.active),this.interaction_.on("change:active",(function(){e.setActive(e.interaction_.getActive())}))),t.toggleFn&&(t.onToggle=t.toggleFn),t.handleClick=function(){e.toggle(),t.onToggle&&t.onToggle.call(e,e.getActive())},t.className=(t.className||"")+" ol-toggle",nh.call(this,t),this.set("title",t.title),this.set("autoActivate",t.autoActivate),t.bar&&(this.subbar_=t.bar,this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar")),this.setActive(t.active),this.setDisable(t.disable)};wt(rh,nh),rh.prototype.setMap=function(t){!t&&this.getMap()&&(this.interaction_&&this.getMap().removeInteraction(this.interaction_),this.subbar_&&this.getMap().removeControl(this.subbar_)),le.prototype.setMap.call(this,t),t&&(this.interaction_&&t.addInteraction(this.interaction_),this.subbar_&&t.addControl(this.subbar_))},rh.prototype.getSubBar=function(){return this.subbar_},rh.prototype.getDisable=function(){var t=this.element.querySelector("button");return t&&t.disabled},rh.prototype.setDisable=function(t){this.getDisable()!=t&&(this.element.querySelector("button").disabled=t,t&&this.getActive()&&this.setActive(!1),this.dispatchEvent({type:"change:disable",key:"disable",oldValue:!t,disable:t}))},rh.prototype.getActive=function(){return this.element.classList.contains("ol-active")},rh.prototype.toggle=function(){this.getActive()?this.setActive(!1):this.setActive(!0)},rh.prototype.setActive=function(t){this.interaction_&&this.interaction_.setActive(t),this.subbar_&&this.subbar_.setActive(t),this.getActive()!==t&&(t?this.element.classList.add("ol-active"):this.element.classList.remove("ol-active"),this.dispatchEvent({type:"change:active",key:"active",oldValue:!t,active:t}))},rh.prototype.setInteraction=function(t){this.interaction_=t},rh.prototype.getInteraction=function(){return this.interaction_};var oh=rh,sh=function(t){(t=t||{}).className=(t.className||"")+" ol-text-button",nh.call(this,t)};wt(sh,nh);var ah=sh,hh=function(t){Qa.a.call(this,t),this.on("select",function(t){this.getFeatures().clear(),this.delete(t.selected)}.bind(this))};wt(hh,Qa.a),hh.prototype._getSources=function(t){if(!this.getMap())return[];t||(t=this.getMap().getLayers());var e=[];return t.forEach(function(t){t.getLayers?e=e.concat(this._getSources(t.getLayers())):t.getSource&&t.getSource()instanceof Ba&&e.push(t.getSource())}.bind(this)),e},hh.prototype.delete=function(t){if(t&&(t.length||t.getLength())){this.dispatchEvent({type:"deletestart",features:t});var e=[];this._getSources().forEach((function(i){try{t.forEach((function(t){i.removeFeature(t),e.push(t)}))}catch(t){}})),this.dispatchEvent({type:"deleteend",features:e})}};var lh=hh,ch=function(t,e){var i=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(i*i+n*n)},uh=function(t,e){return t[0]==e[0]&&t[1]==e[1]},fh=function(t,e){var i,n,r,o,s,a,h,l,c,u,f,p,d,_=[],g=t.length-1,y=g,v=uh(t[0],t[g]);v||(f=t[0],p=t[1],d=[f[0]+(p[1]-f[1])/ch(f,p)*e,f[1]-(p[0]-f[0])/ch(f,p)*e],_.push(d),t.push(t[g]),g++,y--);for(var m=0;m<y;m++)f=t[m],p=t[(m+1)%g],d=t[(m+2)%g],i=(p[1]-f[1])/(p[0]-f[0]),n=(d[1]-p[1])/(d[0]-p[0]),Math.abs(i-n)>1e-10&&(r=Math.sqrt((p[0]-f[0])*(p[0]-f[0])+(p[1]-f[1])*(p[1]-f[1])),o=Math.sqrt((d[0]-p[0])*(d[0]-p[0])+(d[1]-p[1])*(d[1]-p[1])),s=f[0]+e*(p[1]-f[1])/r,c=(n*(a=p[0]+e*(d[1]-p[1])/o)-i*s+(h=f[1]-e*(p[0]-f[0])/r)-(l=p[1]-e*(d[0]-p[0])/o))/(n-i),u=(i*n*(a-s)+n*h-i*l)/(n-i),p[0]-f[0]==0&&(u=n*(c=p[0]+e*(p[1]-f[1])/Math.abs(p[1]-f[1]))-n*a+l),d[0]-p[0]==0&&(u=i*(c=d[0]+e*(d[1]-p[1])/Math.abs(d[1]-p[1]))-i*s+h),_.push([c,u]));return v?_.push(_[0]):(t.pop(),f=t[t.length-1],p=t[t.length-2],d=[f[0]-(p[1]-f[1])/ch(f,p)*e,f[1]+(p[0]-f[0])/ch(f,p)*e],_.push(d)),_},ph=function(t,e){for(var i=0;i<e.length-1;i++){var n=e[i],r=e[i+1];if(uh(t,n)||uh(t,r))return{index:1,segment:[n,r]};var o=ch(n,r),s=[(r[0]-n[0])/o,(r[1]-n[1])/o],a=ch(n,t),h=[(t[0]-n[0])/a,(t[1]-n[1])/a];if(Math.abs(s[0]*h[1]-s[1]*h[0])<1e-10)return{index:1,segment:[n,r]}}return{index:-1}},dh=function(t){t||(t={}),Ir.call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this.features_=t.features,this.layers_=t.layers?t.layers instanceof Array?t.layers:[t.layers]:null,this.set("duplicate",t.duplicate),this.source_=t.source,this.previousCursor_=!1};wt(dh,Ir),dh.prototype.setMap=function(t){Ir.prototype.setMap.call(this,t)},dh.prototype.getFeatureAtPixel_=function(t){var e=this;return this.getMap().forEachFeatureAtPixel(t.pixel,(function(i,n){var r;if(e.layers_){for(var o=0;o<e.layers_.length;o++)if(e.layers_[o]===n){r=i;break}}else e.features_?e.features_.forEach((function(t){t===i&&(r=i)})):r=i;var s=r.getGeometry().getType();if(r&&/Polygon|LineString/.test(s)){if("Polygon"===s&&r.getGeometry().getCoordinates().length>1)return!1;var a=r.getGeometry().getClosestPoint(t.coordinate),h=a[0]-t.coordinate[0],l=a[1]-t.coordinate[1];return Math.sqrt(h*h+l*l)/t.frameState.viewState.resolution<5&&{feature:r,hit:a,coordinates:r.getGeometry().getCoordinates(),geom:r.getGeometry().clone(),geomType:s}}return!1}),{hitTolerance:5})},dh.prototype.handleDownEvent_=function(t){return this.current_=this.getFeatureAtPixel_(t),this.source_&&(this.get("duplicate")||t.originalEvent.ctrlKey)?(this.current_.feature=this.current_.feature.clone(),this.source_.addFeature(this.current_.feature)):this.current_&&this.dispatchEvent({type:"modifystart",features:[this.current_.feature]}),!!this.current_&&(this.dispatchEvent({type:"offsetstart",feature:this.current_.feature,offset:0}),!0)},dh.prototype.handleDragEvent_=function(t){var e,i,n,r,o=this.current_.geom.getClosestPoint(t.coordinate),s=ch(o,t.coordinate);switch(this.current_.geomType){case"Polygon":if(e=ph(o,this.current_.coordinates[0]).segment){i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],n=[t.coordinate[0]-o[0],t.coordinate[1]-o[1]],i[0]*n[1]-i[1]*n[0]>0&&(s=-s),r=[];for(var a=0;a<this.current_.coordinates.length;a++)r.push(fh(this.current_.coordinates[a],0==a?s:-s));this.current_.feature.setGeometry(new mr(r))}break;case"LineString":(e=ph(o,this.current_.coordinates).segment)&&(i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],n=[t.coordinate[0]-o[0],t.coordinate[1]-o[1]],i[0]*n[1]-i[1]*n[0]>0&&(s=-s),r=fh(this.current_.coordinates,s),this.current_.feature.setGeometry(new tr(r)))}this.dispatchEvent({type:"offsetting",feature:this.current_.feature,offset:s,segment:[o,t.coordinate],coordinate:t.coordinate})},dh.prototype.handleUpEvent_=function(t){this.dispatchEvent({type:"offsetend",feature:this.current_.feature,coordinate:t.coordinate}),this.current_=!1},dh.prototype.handleMoveEvent_=function(t){this.getFeatureAtPixel_(t)?(!1===this.previousCursor_&&(this.previousCursor_=t.map.getTargetElement().style.cursor),t.map.getTargetElement().style.cursor="pointer"):(t.map.getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=!1)};var _h=dh;tr.prototype.splitAt=function(t,e){var i;if(!t)return[this];if(e||(e=1e-10),t.length&&t[0].length){var n=[this];for(i=0;i<t.length;i++){for(var r=[],o=0;o<n.length;o++){var s=n[o].splitAt(t[i],e);r=r.concat(s)}n=r}return n}if(uh(t,this.getFirstCoordinate())||uh(t,this.getLastCoordinate()))return[this];var a=this.getCoordinates(),h=[a[0]],l=[];for(i=0;i<a.length-1;i++)if(!uh(a[i],a[i+1])){if(uh(t,a[i+1]))h.push(a[i+1]),l.push(new tr(h)),h=[];else if(!uh(t,a[i])){var c,u,f=!1;a[i][0]==a[i+1][0]?(c=(a[i][1]-t[1])/(a[i][1]-a[i+1][1]),f=a[i][0]==t[0]&&0<c&&c<=1):a[i][1]==a[i+1][1]?(c=(a[i][0]-t[0])/(a[i][0]-a[i+1][0]),f=a[i][1]==t[1]&&0<c&&c<=1):(c=(a[i][0]-t[0])/(a[i][0]-a[i+1][0]),u=(a[i][1]-t[1])/(a[i][1]-a[i+1][1]),f=Math.abs(c-u)<=e&&0<c&&c<=1),f&&(h.push(t),l.push(new tr(h)),h=[t])}h.push(a[i+1])}return h.length>1&&l.push(new tr(h)),l.length?l:[this]};var gh=function(t){t||(t={}),kr.call(this,{handleEvent:function(t){switch(t.type){case"singleclick":return this.handleDownEvent(t);case"pointermove":return this.handleMoveEvent(t);default:return!0}}}),this.snapDistance_=t.snapDistance||25,this.tolerance_=t.tolerance||1e-10,this.cursor_=t.cursor,this.sources_=t.sources?t.sources instanceof Array?t.sources:[t.sources]:[],t.features&&this.sources_.push(new Ba({features:t.features})),this.filterSplit_=t.filter||function(){return!0};var e=[255,255,255,1],i=[0,153,255,1],n=new Ao({color:"rgba(255,255,255,0.4)"}),r=new jo({color:"#3399CC",width:1.25}),o=[new Yo({image:new Ro({fill:n,stroke:r,radius:5}),fill:n,stroke:r})],s=[new Yo({stroke:new jo({color:e,width:5})}),new Yo({image:new Ro({radius:6,fill:new Ao({color:i}),stroke:new jo({color:e,width:1.5})}),stroke:new jo({color:i,width:3})})];t.sketchStyle&&(o=t.sketchStyle instanceof Array?t.sketchStyle:[t.sketchStyle]),t.featureStyle&&(s=t.featureStyle instanceof Array?t.featureStyle:[t.featureStyle]),this.overlayLayer_=new H.a({source:new Ba({useSpatialIndex:!1}),name:"Split overlay",displayInLayerSwitcher:!1,style:function(t){return t._sketch_?o:s}})};wt(gh,kr),gh.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),kr.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},gh.prototype.getClosestFeature=function(t){for(var e,i,n,r=this.snapDistance_+1,o=0;o<this.sources_.length;o++){var s=this.sources_[o];if((e=s.getClosestFeatureToCoordinate(t.coordinate))&&e.getGeometry().splitAt){i=e.getGeometry().getClosestPoint(t.coordinate),r=(n=new tr([t.coordinate,i])).getLength()/t.frameState.viewState.resolution;break}}if(r>this.snapDistance_)return!1;var a=this.getNearestCoord(i,e.getGeometry().getCoordinates()),h=this.getMap().getPixelFromCoordinate(a);return ch(t.pixel,h)<this.snapDistance_&&(i=a),{source:s,feature:e,coord:i,link:n}},gh.prototype.getNearestCoord=function(t,e){for(var i,n,r=Number.MAX_VALUE,o=0;o<e.length;o++)(i=ch(t,e[o]))<r&&(r=i,n=e[o]);return n},gh.prototype.handleDownEvent=function(t){var e=this.getClosestFeature(t);if(e){this.overlayLayer_.getSource().clear();var i,n=e.feature.getGeometry().splitAt(e.coord,this.tolerance_);if(n.length>1){var r=[];for(i=0;i<n.length;i++){var o=e.feature.clone();o.setGeometry(n[i]),r.push(o)}for(this.dispatchEvent({type:"beforesplit",original:e.feature,features:r}),e.source.dispatchEvent({type:"beforesplit",original:e.feature,features:r}),e.source.removeFeature(e.feature),i=0;i<r.length;i++)e.source.addFeature(r[i]);this.dispatchEvent({type:"aftersplit",original:e.feature,features:r}),e.source.dispatchEvent({type:"aftersplit",original:e.feature,features:r})}}return!1},gh.prototype.handleMoveEvent=function(t){var e=t.map;this.overlayLayer_.getSource().clear();var i,n,r=this.getClosestFeature(t);r&&this.filterSplit_(r.feature)?(this.overlayLayer_.getSource().addFeature(r.feature),(i=new ye(new rr(r.coord)))._sketch_=!0,this.overlayLayer_.getSource().addFeature(i),(n=new ye(r.link))._sketch_=!0,this.overlayLayer_.getSource().addFeature(n),this.dispatchEvent({type:"pointermove",coordinate:t.coordinate,frameState:t.frameState,originalEvent:t.originalEvent,map:t.map,pixel:t.pixel,feature:r.feature,linkGeometry:r.link})):this.dispatchEvent(t);var o=e.getTargetElement();this.cursor_&&(r?o.style.cursor!=this.cursor_&&(this.previousCursor_=o.style.cursor,o.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(o.style.cursor=this.previousCursor_,this.previousCursor_=void 0))};var yh=gh,vh=function(t){t||(t={});var e=this;this.selection_=new ba,this.handles_=new ba,this.overlayLayer_=new H.a({source:new Ba({features:this.handles_,useSpatialIndex:!1,wrapX:!1}),name:"Transform overlay",displayInLayerSwitcher:!1,style:function(t){return e.style[(t.get("handle")||"default")+(t.get("constraint")||"")+(t.get("option")||"")]}}),Ir.call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this.features_=t.features,"function"==typeof t.filter&&(this._filter=t.filter),this.layers_=t.layers?t.layers instanceof Array?t.layers:[t.layers]:null,this._handleEvent=t.condition||function(){return!0},this.addFn_=t.addCondition||function(){return!1},this.set("translateFeature",!1!==t.translateFeature),this.set("translate",!1!==t.translate),this.set("translateBBox",!0===t.translateBBox),this.set("stretch",!1!==t.stretch),this.set("scale",!1!==t.scale),this.set("rotate",!1!==t.rotate),this.set("keepAspectRatio",t.keepAspectRatio||function(t){return t.originalEvent.shiftKey}),this.set("modifyCenter",t.modifyCenter||function(t){return t.originalEvent.metaKey||t.originalEvent.ctrlKey}),this.set("noFlip",t.noFlip||!1),this.set("selection",!1!==t.selection),this.set("hitTolerance",t.hitTolerance||0),this.set("enableRotatedTransform",t.enableRotatedTransform||!1),this.on("propertychange",(function(){this.drawSketch_()})),this.setDefaultStyle()};wt(vh,Ir),vh.prototype.Cursors={default:"auto",select:"pointer",translate:"move",rotate:"move",rotate0:"move",scale:"nesw-resize",scale1:"nwse-resize",scale2:"nesw-resize",scale3:"nwse-resize",scalev:"ew-resize",scaleh1:"ns-resize",scalev2:"ew-resize",scaleh3:"ns-resize"},vh.prototype.setMap=function(t){this.getMap()&&(this.getMap().removeLayer(this.overlayLayer_),this.previousCursor_&&(this.getMap().getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=void 0)),Ir.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t),null===t&&this.select(null),null!==t&&(this.isTouch=/touch/.test(t.getViewport().className),this.setDefaultStyle())},vh.prototype.setActive=function(t){this.select(null),this.overlayLayer_.setVisible(t),Ir.prototype.setActive.call(this,t)},vh.prototype.setDefaultStyle=function(){var t=new jo({color:[255,0,0,1],width:1}),e=new jo({color:[255,0,0,1],width:1,lineDash:[4,4]}),i=new Ao({color:[255,0,0,.01]}),n=new Ao({color:[255,255,255,.8]}),r=new Lo({fill:n,stroke:t,radius:this.isTouch?12:6,points:15});r.getAnchor()[0]=this.isTouch?-10:-5;var o=new Lo({fill:n,stroke:t,radius:this.isTouch?16:8,points:4,angle:Math.PI/4}),s=new Lo({fill:n,stroke:t,radius:this.isTouch?12:6,points:4,angle:Math.PI/4});function a(t,e,i){return[new Yo({image:t,stroke:e,fill:i})]}this.style={default:a(o,e,i),translate:a(o,t,n),rotate:a(r,t,n),rotate0:a(o,t,n),scale:a(o,t,n),scale1:a(o,t,n),scale2:a(o,t,n),scale3:a(o,t,n),scalev:a(s,t,n),scaleh1:a(s,t,n),scalev2:a(s,t,n),scaleh3:a(s,t,n)},this.drawSketch_()},vh.prototype.setStyle=function(t,e){if(e){this.style[t]=e instanceof Array?e:[e];for(var i=0;i<this.style[t].length;i++){var n=this.style[t][i].getImage();n&&("rotate"==t&&(n.getAnchor()[0]=-5),this.isTouch&&n.setScale(1.8));var r=this.style[t][i].getText();r&&("rotate"==t&&r.setOffsetX(this.isTouch?14:7),this.isTouch&&r.setScale(1.8))}this.drawSketch_()}},vh.prototype.getFeatureAtPixel_=function(t){var e=this;return this.getMap().forEachFeatureAtPixel(t,(function(t,i){var n=!1;if(!i){if(t===e.bbox_)return!!e.get("translateBBox")&&{feature:t,handle:"translate",constraint:"",option:""};if(e.handles_.forEach((function(e){e===t&&(n=!0)})),n)return{feature:t,handle:t.get("handle"),constraint:t.get("constraint"),option:t.get("option")}}if(!e.get("selection"))return e.selection_.getArray().some((function(e){return t===e}))?{feature:t}:null;if(e._filter)return e._filter(t,i)?{feature:t}:null;if(e.layers_){for(var r=0;r<e.layers_.length;r++)if(e.layers_[r]===i)return{feature:t};return null}return e.features_?(e.features_.forEach((function(e){e===t&&(n=!0)})),n?{feature:t}:null):{feature:t}}),{hitTolerance:this.get("hitTolerance")})||{}},vh.prototype.getGeometryRotateToZero_=function(t,e){var i=t.getGeometry(),n=this.getMap().getView().getRotation();if(0===n||!this.get("enableRotatedTransform"))return e?i.clone():i;var r=i.clone();return r.rotate(-1*n,this.getMap().getView().getCenter()),r},vh.prototype.drawSketch_=function(t){var e,i,n;if(this.overlayLayer_.getSource().clear(),this.selection_.getLength()){var r=this.getMap().getView().getRotation(),o=this.getGeometryRotateToZero_(this.selection_.item(0)).getExtent();if(o=Ue(o,0),this.selection_.forEach(function(t){var e=this.getGeometryRotateToZero_(t).getExtent();ri(o,e)}.bind(this)),!0===t)this.ispt_||(this.overlayLayer_.getSource().addFeature(new ye({geometry:new rr(this.center_),handle:"rotate0"})),n=wr(o),this.get("enableRotatedTransform")&&0!==r&&n.rotate(r,this.getMap().getView().getCenter()),i=this.bbox_=new ye(n),this.overlayLayer_.getSource().addFeature(i));else{if(this.ispt_){var s=this.getMap().getPixelFromCoordinate([o[0],o[1]]);o=Ke([this.getMap().getCoordinateFromPixel([s[0]-10,s[1]-10]),this.getMap().getCoordinateFromPixel([s[0]+10,s[1]+10])])}n=wr(o),this.get("enableRotatedTransform")&&0!==r&&n.rotate(r,this.getMap().getView().getCenter()),i=this.bbox_=new ye(n);var a=[],h=n.getCoordinates()[0];if(!this.ispt_){if(a.push(i),!this.iscircle_&&this.get("stretch")&&this.get("scale"))for(e=0;e<h.length-1;e++)i=new ye({geometry:new rr([(h[e][0]+h[e+1][0])/2,(h[e][1]+h[e+1][1])/2]),handle:"scale",constraint:e%2?"h":"v",option:e}),a.push(i);if(this.get("scale"))for(e=0;e<h.length-1;e++)i=new ye({geometry:new rr(h[e]),handle:"scale",option:e}),a.push(i);this.get("translate")&&!this.get("translateFeature")&&(i=new ye({geometry:new rr([(h[0][0]+h[2][0])/2,(h[0][1]+h[2][1])/2]),handle:"translate"}),a.push(i))}!this.iscircle_&&this.get("rotate")&&(i=new ye({geometry:new rr(h[3]),handle:"rotate"}),a.push(i)),this.overlayLayer_.getSource().addFeatures(a)}}},vh.prototype.select=function(t,e){if(!t)return this.selection_.clear(),void this.drawSketch_();if(t.getGeometry&&t.getGeometry()){if(e)this.selection_.push(t);else{var i=this.selection_.getArray().indexOf(t);this.selection_.removeAt(i)}this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:t,features:this.selection_})}},vh.prototype.setSelection=function(t){this.selection_.clear(),t.forEach(t=>{this.selection_.push(t)}),this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",features:this.selection_})},vh.prototype.watchFeatures_=function(){this._featureListeners&&this._featureListeners.forEach((function(t){$t(t)})),this._featureListeners=[],this.selection_.forEach(function(t){this._featureListeners.push(t.on("change",function(){this.isUpdating_||this.drawSketch_()}.bind(this)))}.bind(this))},vh.prototype.handleDownEvent_=function(t){if(this._handleEvent(t,this.selection_)){var e=this.getFeatureAtPixel_(t.pixel),i=e.feature;if(this.selection_.getLength()&&this.selection_.getArray().indexOf(i)>=0&&(this.ispt_&&this.get("translate")||this.get("translateFeature"))&&(e.handle="translate"),e.handle){this.mode_=e.handle,this.opt_=e.option,this.constraint_=e.constraint;var n=this.getMap().getView().getRotation();this.coordinate_=t.coordinate,this.pixel_=t.pixel,this.geoms_=[],this.rotatedGeoms_=[];for(var r,o=[1/0,1/0,-1/0,-1/0],s=[1/0,1/0,-1/0,-1/0],a=0;r=this.selection_.item(a);a++)if(this.geoms_.push(r.getGeometry().clone()),o=ri(o,r.getGeometry().getExtent()),this.get("enableRotatedTransform")&&0!==n){var h=this.getGeometryRotateToZero_(r,!0);this.rotatedGeoms_.push(h),s=ri(s,h.getExtent())}if(this.extent_=wr(o).getCoordinates()[0],this.get("enableRotatedTransform")&&0!==n&&(this.rotatedExtent_=wr(s).getCoordinates()[0]),"rotate"===this.mode_){this.center_=this.getCenter()||ui(o);var l=t.map.getTargetElement();l.style.cursor=this.Cursors.rotate0,this.previousCursor_=l.style.cursor}else this.center_=ui(o);return this.angle_=Math.atan2(this.center_[1]-t.coordinate[1],this.center_[0]-t.coordinate[0]),this.dispatchEvent({type:this.mode_+"start",feature:this.selection_.item(0),features:this.selection_,pixel:t.pixel,coordinate:t.coordinate}),!0}if(this.get("selection")){if(i){this.addFn_(t)||this.selection_.clear();var c=this.selection_.getArray().indexOf(i);c<0?this.selection_.push(i):this.selection_.removeAt(c)}else this.selection_.clear();return this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:i,features:this.selection_,pixel:t.pixel,coordinate:t.coordinate}),!1}}},vh.prototype.getFeatures=function(){return this.selection_},vh.prototype.getCenter=function(){return this.get("center")},vh.prototype.setCenter=function(t){return this.set("center",t)},vh.prototype.handleDragEvent_=function(t){if(this._handleEvent(t,this.features_)){var e,i,n,r=this.getMap().getView().getRotation(),o=[this.coordinate_[0],this.coordinate_[1]],s=[t.coordinate[0],t.coordinate[1]];switch(this.isUpdating_=!0,this.mode_){case"rotate":var a=Math.atan2(this.center_[1]-s[1],this.center_[0]-s[0]);if(!this.ispt)for(e=0;i=this.selection_.item(e);e++)(n=this.geoms_[e].clone()).rotate(a-this.angle_,this.center_),"Circle"==n.getType()&&n.setCenterAndRadius(n.getCenter(),n.getRadius()),i.setGeometry(n);this.drawSketch_(!0),this.dispatchEvent({type:"rotating",feature:this.selection_.item(0),features:this.selection_,angle:a-this.angle_,pixel:t.pixel,coordinate:t.coordinate});break;case"translate":var h=s[0]-o[0],l=s[1]-o[1];for(e=0;i=this.selection_.item(e);e++)i.getGeometry().translate(h,l);this.handles_.forEach((function(t){t.getGeometry().translate(h,l)})),this.coordinate_=t.coordinate,this.dispatchEvent({type:"translating",feature:this.selection_.item(0),features:this.selection_,delta:[h,l],pixel:t.pixel,coordinate:t.coordinate});break;case"scale":var c=this.center_;if(this.get("modifyCenter")(t)){var u=this.extent_;this.get("enableRotatedTransform")&&0!==r&&(u=this.rotatedExtent_),c=u[(Number(this.opt_)+2)%4]}var f=this.coordinate_,p=t.coordinate;if(this.get("enableRotatedTransform")&&0!==r){var d=new rr(this.coordinate_);d.rotate(-1*r,c),f=d.getCoordinates();var _=new rr(t.coordinate);_.rotate(-1*r,c),p=_.getCoordinates()}var g=(p[0]-c[0])/(f[0]-c[0]),y=(p[1]-c[1])/(f[1]-c[1]);if(this.get("enableRotatedTransform")&&0!==r){var v=new rr(c);v.rotate(-1*r,this.getMap().getView().getCenter()),c=v.getCoordinates()}for(this.get("noFlip")&&(g<0&&(g=-g),y<0&&(y=-y)),this.constraint_?"h"==this.constraint_?g=1:y=1:this.get("keepAspectRatio")(t)&&(g=y=Math.min(g,y)),e=0;i=this.selection_.item(e);e++)(n=0!==r&&this.get("enableRotatedTransform")?this.rotatedGeoms_[e].clone():this.geoms_[e].clone()).applyTransform((function(t,e,i){if(i<2)return e;for(var r=0;r<t.length;r+=i)1!=g&&(e[r]=c[0]+(t[r]-c[0])*g),1!=y&&(e[r+1]=c[1]+(t[r+1]-c[1])*y);return"Circle"==n.getType()&&n.setCenterAndRadius(n.getCenter(),n.getRadius()),e})),this.get("enableRotatedTransform")&&0!==r&&n.rotate(r,this.getMap().getView().getCenter()),i.setGeometry(n);this.drawSketch_(),this.dispatchEvent({type:"scaling",feature:this.selection_.item(0),features:this.selection_,scale:[g,y],pixel:t.pixel,coordinate:t.coordinate})}this.isUpdating_=!1}},vh.prototype.handleMoveEvent_=function(t){if(this._handleEvent(t,this.features_)&&!this.mode_){var e=this.getFeatureAtPixel_(t.pixel),i=t.map.getTargetElement();if(e.feature){var n=e.handle?this.Cursors[(e.handle||"default")+(e.constraint||"")+(e.option||"")]:this.Cursors.select;void 0===this.previousCursor_&&(this.previousCursor_=i.style.cursor),i.style.cursor=n}else void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_),this.previousCursor_=void 0}},vh.prototype.handleUpEvent_=function(t){"rotate"===this.mode_&&(t.map.getTargetElement().style.cursor=this.Cursors.default,this.previousCursor_=void 0);return this.dispatchEvent({type:this.mode_+"end",feature:this.selection_.item(0),features:this.selection_,oldgeom:this.geoms_[0],oldgeoms:this.geoms_}),this.drawSketch_(),this.mode_=null,!1},vh.prototype.getFeatures=function(){return this.selection_};var mh=vh,wh=function(t){var e,i;t||(t={}),Ir.call(this,{handleEvent:function(t){switch(t.type){case"pointerdown":return e=this.handleDownEvent(t),i=e||this._deleteCondition(t),!e;case"pointerup":return e=!1,this.handleUpEvent(t);case"pointerdrag":return!e||this.handleDragEvent(t);case"pointermove":return!!e||this.handleMoveEvent(t);case"singleclick":case"click":return!i;default:return!0}}}),this.snapDistance_=t.pixelTolerance||10,this.tolerance_=1e-10,this.cursor_=t.cursor,this.sources_=t.sources?t.sources instanceof Array?t.sources:[t.sources]:[],t.features&&this.sources_.push(new Ba({features:t.features})),this.filterSplit_=t.filter||function(){return!0},this._condition=t.condition||fe.primaryAction,this._deleteCondition=t.deleteCondition||fe.altKeyOnly,this._insertVertexCondition=t.insertVertexCondition||fe.always;var n=function(){return[new Yo({image:new Ro({radius:6,fill:new Ao({color:[0,153,255,1]}),stroke:new jo({color:"#FFF",width:1.25})})})]};t.style&&(n="function"==typeof t.style?t.style:function(){return t.style}),this.overlayLayer_=new H.a({source:new Ba({useSpatialIndex:!1}),name:"Modify overlay",displayInLayerSwitcher:!1,style:n})};wt(wh,Ir),wh.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),kr.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},wh.prototype.setActive=function(t){kr.prototype.setActive.call(this,t),this.overlayLayer_&&this.overlayLayer_.getSource().clear()},wh.prototype.getClosestFeature=function(t){for(var e,i,n=this.snapDistance_+1,r=0;r<this.sources_.length;r++){var o=this.sources_[r];if((e=o.getClosestFeatureToCoordinate(t.coordinate))&&this.filterSplit_(e)){var s=e.getGeometry().getClosestPoint(t.coordinate),a=ch(t.coordinate,s)/t.frameState.viewState.resolution;a<n&&(n=a,i=s);break}}if(n>this.snapDistance_)return!1;var h=this.getNearestCoord(i,e.getGeometry());if(h){h=h.coord;var l=this.getMap().getPixelFromCoordinate(h);return ch(t.pixel,l)<this.snapDistance_&&(i=h),{source:o,feature:e,coord:i}}},wh.prototype.getNearestCoord=function(t,e){var i,n,r,o,s;switch(e.getType()){case"Point":return{coord:e.getCoordinates(),dist:ch(e.getCoordinates(),t)};case"MultiPoint":return this.getNearestCoord(t,new tr(e.getCoordinates()));case"LineString":case"LinearRing":var a;s=Number.MAX_VALUE;var h=e.getCoordinates();for(i=0;i<h.length;i++)(a=ch(t,h[i]))<s&&(s=a,o=h[i]);return{coord:o,dist:s};case"MultiLineString":var l=e.getLineStrings();for(o=!1,s=Number.MAX_VALUE,i=0;n=l[i];i++)(r=this.getNearestCoord(t,n))&&r.dist<s&&(o=r,s=r.dist,o.ring=i);return o;case"Polygon":var c=e.getLinearRings();for(o=!1,s=Number.MAX_VALUE,i=0;n=c[i];i++)(r=this.getNearestCoord(t,n))&&r.dist<s&&(o=r,s=r.dist,o.ring=i);return o;case"MultiPolygon":var u=e.getPolygons();for(o=!1,s=Number.MAX_VALUE,i=0;n=u[i];i++)(r=this.getNearestCoord(t,n))&&r.dist<s&&(o=r,s=r.dist,o.poly=i);return o;case"GeometryCollection":var f=e.getGeometries();for(o=!1,s=Number.MAX_VALUE,i=0;n=f[i];i++)(r=this.getNearestCoord(t,n))&&r.dist<s&&(o=r,s=r.dist,o.geom=i);return o;default:return!1}},wh.prototype.getArcs=function(t,e){var i,n,r,o,s=!1;switch(t.getType()){case"Point":uh(e,t.getCoordinates())&&(s={geom:t,type:t.getType(),coord1:[],coord2:[],node:!0});break;case"MultiPoint":for(i=t.getCoordinates(),n=0;n<i.length;n++)if(uh(e,i[n])){s={geom:t,type:t.getType(),index:n,coord1:[],coord2:[],node:!0};break}break;case"LinearRing":case"LineString":var a=t.getClosestPoint(e);if(ch(a,e)<1.5*this.tolerance_){var h;if("LinearRing"===t.getType()){var l=new tr(t.getCoordinates());h=l.splitAt(e,this.tolerance_)}else h=t.splitAt(e,this.tolerance_);if(h.length>2){for(i=h[1].getCoordinates(),n=2;r=h[n];n++){var c=r.getCoordinates();c.shift(),i=i.concat(c)}h=[h[0],new tr(i)]}if(2===h.length){var u=h[0].getCoordinates(),f=h[1].getCoordinates(),p=u.length+f.length-1;u.pop(),f.shift(),s={geom:t,type:t.getType(),coord1:u,coord2:f,node:t.getCoordinates().length===p,closed:!1}}else if(1===h.length){r=h[0].getCoordinates();var d=uh(r[0],e),_=uh(r[r.length-1],e);d?(r.shift(),_&&r.pop(),s={geom:t,type:t.getType(),coord1:[],coord2:r,node:!0,closed:_}):_&&(r.pop(),s={geom:t,type:t.getType(),coord1:r,coord2:[],node:!0,closed:!1})}}break;case"MultiLineString":var g=t.getLineStrings();for(n=0;o=g[n];n++)if(s=this.getArcs(o,e)){s.geom=t,s.type=t.getType(),s.lstring=n;break}break;case"Polygon":var y=t.getLinearRings();for(n=0;o=y[n];n++)if(s=this.getArcs(o,e)){s.geom=t,s.type=t.getType(),s.index=n;break}break;case"MultiPolygon":var v=t.getPolygons();for(n=0;o=v[n];n++)if(s=this.getArcs(o,e)){s.geom=t,s.type=t.getType(),s.poly=n;break}break;case"GeometryCollection":for(n=0;o=l[n];n++)if(s=this.getArcs(o,e)){s.geom=t,s.g=n,s.typeg=s.type,s.type=t.getType();break}break;default:console.error("ol/interaction/ModifyFeature "+t.getType()+" not supported!")}return s},wh.prototype.handleDownEvent=function(t){if(!this.getActive())return!1;var e=this.getClosestFeature(t);if(e&&(this._condition(t)||this._deleteCondition(t))){var i=[];return this.arcs=[],this.sources_.forEach(function(t){var n=Ue(Ke([e.coord]),this.tolerance_);i=i.concat(i,t.getFeaturesInExtent(n))}.bind(this)),this._modifiedFeatures=[],i.forEach(function(i){var n=this.getArcs(i.getGeometry(),e.coord);n&&(this._insertVertexCondition(t)||n.node)&&(n.feature=i,this._modifiedFeatures.push(i),this.arcs.push(n))}.bind(this)),!this._modifiedFeatures.length||(this._deleteCondition(t)?!this._removePoint(e,t):(this.dispatchEvent({type:"modifystart",coordinate:e.coord,originalEvent:t.originalEvent,features:this._modifiedFeatures}),this.handleDragEvent({coordinate:e.coord}),!0))}return!1},wh.prototype.getModifiedFeatures=function(){return this._modifiedFeatures||[]},wh.prototype.removePoint=function(){this._removePoint({},{})},wh.prototype._getModification=function(t){var e=t.coord1.concat(t.coord2);switch(t.type){case"LineString":if(t.closed&&e.push(e[0]),e.length>1&&t.geom.getCoordinates().length!=e.length)return t.coords=e,!0;break;case"MultiLineString":if(t.closed&&e.push(e[0]),e.length>1){var i=t.geom.getCoordinates();if(i[t.lstring].length!=e.length)return i[t.lstring]=e,t.coords=i,!0}break;case"Polygon":if(t.closed&&e.push(e[0]),e.length>3&&(i=t.geom.getCoordinates())[t.index].length!=e.length)return i[t.index]=e,t.coords=i,!0;break;case"MultiPolygon":if(t.closed&&e.push(e[0]),e.length>3&&(i=t.geom.getCoordinates())[t.poly][t.index].length!=e.length)return i[t.poly][t.index]=e,t.coords=i,!0;break;case"GeometryCollection":t.type=t.typeg;var n=t.geom,r=n.getGeometries();t.geom=r[t.g];var o=this._getModification(t);return n.setGeometries(r),t.geom=n,t.type="GeometryCollection",o}return!1},wh.prototype._removePoint=function(t,e){if(!this.arcs)return!1;this.overlayLayer_.getSource().clear();var i=!1;return this.arcs.forEach(function(t){i=i||this._getModification(t)}.bind(this)),i&&(this.dispatchEvent({type:"modifystart",coordinate:t.coord,originalEvent:e.originalEvent,features:this._modifiedFeatures}),this.arcs.forEach(function(t){if("GeometryCollection"===t.geom.getType()){if(t.coords){var e=t.geom.getGeometries();e[t.g].setCoordinates(t.coords),t.geom.setGeometries(e)}}else t.coords&&t.geom.setCoordinates(t.coords)}.bind(this)),this.dispatchEvent({type:"modifyend",coordinate:t.coord,originalEvent:e.originalEvent,features:this._modifiedFeatures})),this.arcs=[],i},wh.prototype.handleUpEvent=function(t){return!!this.getActive()&&(!this.arcs||!this.arcs.length||(this.overlayLayer_.getSource().clear(),this.dispatchEvent({type:"modifyend",coordinate:t.coordinate,originalEvent:t.originalEvent,features:this._modifiedFeatures}),this.arcs=[],!0))},wh.prototype.setArcCoordinates=function(t,e){var i;switch(t.type){case"Point":t.geom.setCoordinates(e[0]);break;case"MultiPoint":(i=t.geom.getCoordinates())[t.index]=e[0],t.geom.setCoordinates(i);break;case"LineString":t.geom.setCoordinates(e);break;case"MultiLineString":(i=t.geom.getCoordinates())[t.lstring]=e,t.geom.setCoordinates(i);break;case"Polygon":(i=t.geom.getCoordinates())[t.index]=e,t.geom.setCoordinates(i);break;case"MultiPolygon":(i=t.geom.getCoordinates())[t.poly][t.index]=e,t.geom.setCoordinates(i);break;case"GeometryCollection":t.type=t.typeg;var n=t.geom,r=n.getGeometries();t.geom=r[t.g],this.setArcCoordinates(t,e),n.setGeometries(r),t.geom=n,t.type="GeometryCollection"}},wh.prototype.handleDragEvent=function(t){if(!this.getActive())return!1;if(!this.arcs)return!0;this.overlayLayer_.getSource().clear();var e=new ye(new rr(t.coordinate));return this.overlayLayer_.getSource().addFeature(e),!this.arcs.length||(this.arcs.forEach(function(e){var i=e.coord1.concat([t.coordinate],e.coord2);e.closed&&i.push(t.coordinate),this.setArcCoordinates(e,i)}.bind(this)),this.dispatchEvent({type:"modifying",coordinate:t.coordinate,originalEvent:t.originalEvent,features:this._modifiedFeatures}),!0)},wh.prototype.handleMoveEvent=function(t){if(!this.getActive())return!1;this.overlayLayer_.getSource().clear();var e=this.getClosestFeature(t);if(e){var i=new ye(new rr(e.coord));this.overlayLayer_.getSource().addFeature(i)}var n=t.map.getTargetElement();this.cursor_&&(e?n.style.cursor!=this.cursor_&&(this.previousCursor_=n.style.cursor,n.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(n.style.cursor=this.previousCursor_,this.previousCursor_=void 0))};var xh=wh,Sh=function(t){t||(t={}),this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.maxCircleCoordinates_=t.maxCircleCoordinates||100,this.features_=t.features,this.source_=t.source,this.squareFn_=t.squareCondition,this.centeredFn_=t.centerCondition,this.canRotate_=!1!==t.canRotate,this.geometryName_=t.geometryName,this.setSides(t.sides);var e=[255,255,255,1],i=[0,153,255,1],n=[new Yo({stroke:new jo({color:e,width:5})}),new Yo({image:new Ro({radius:6,fill:new Ao({color:i}),stroke:new jo({color:e,width:1.5})}),stroke:new jo({color:i,width:3}),fill:new Ao({color:[255,255,255,.5]})})];this.sketch_=new ba,this.overlayLayer_=new H.a({source:new Ba({features:this.sketch_,useSpatialIndex:!1}),name:"DrawRegular overlay",displayInLayerSwitcher:!1,style:t.style||n}),kr.call(this,{handleEvent:this.handleEvent_})};wt(Sh,kr),Sh.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),kr.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},Sh.prototype.setActive=function(t){this.reset(),kr.prototype.setActive.call(this,t)},Sh.prototype.reset=function(){this.overlayLayer_.getSource().clear(),this.started_=!1},Sh.prototype.setSides=function(t){t=parseInt(t),this.sides_=t>2?t:0},Sh.prototype.canRotate=function(t){return!0!==t&&!1!==t||(this.canRotate_=t),this.canRotate_},Sh.prototype.getSides=function(){return this.sides_},Sh.prototype.startAngle={default:Math.PI/2,3:-Math.PI/2,4:Math.PI/4},Sh.prototype.getGeom_=function(){if(this.overlayLayer_.getSource().clear(),!this.center_)return!1;var t;if(this.coord_){var e,i,n,r,o,s=this.center_,a=this.coord_;if(!this.sides_&&this.square_&&!this.centered_)return s=[(a[0]+s[0])/2,(a[1]+s[1])/2],e=[a[0]-s[0],a[1]-s[1]],n=Math.sqrt(e[0]*e[0]+e[1]*e[1]),r=new Tn(s,n,"XY"),o=this.getMap().getPixelFromCoordinate(s),i=Math.max(100,Math.abs(o[0]-this.coordPx_[0]),Math.abs(o[1]-this.coordPx_[1])),xr(r,i=Math.min(this.maxCircleCoordinates_,Math.round(i/3)),0);var h=this.canRotate_&&this.centered_&&this.square_;if(e=[a[0]-s[0],a[1]-s[1]],this.square_&&!h){var l=Math.max(Math.abs(e[0]),Math.abs(e[1]));a=[s[0]+(e[0]>0?l:-l),s[1]+(e[1]>0?l:-l)]}if((n=Math.sqrt(e[0]*e[0]+e[1]*e[1]))>0){var c;if(r=new Tn(s,n,"XY"),c=h?Math.atan2(e[1],e[0]):this.startAngle[this.sides_]||this.startAngle.default,this.sides_?t=xr(r,this.sides_,c):(o=this.getMap().getPixelFromCoordinate(this.center_),i=Math.max(100,Math.abs(o[0]-this.coordPx_[0]),Math.abs(o[1]-this.coordPx_[1])),t=xr(r,i=Math.min(this.maxCircleCoordinates_,Math.round(i/(this.centered_?3:5))),0)),h)return t;var u=t.getExtent(),f=((s=this.centered_?[2*this.center_[0]-this.coord_[0],2*this.center_[1]-this.coord_[1]]:this.center_)[0]-a[0])/(u[0]-u[2]),p=(s[1]-a[1])/(u[1]-u[3]);if(this.square_){var d=Math.min(Math.abs(f),Math.abs(p));f=Math.sign(f)*d,p=Math.sign(p)*d}var _=[s[0]-u[0]*f,s[1]-u[1]*p];return t.applyTransform((function(t,e,i){for(var n=0;n<t.length;n+=i)e[n]=t[n]*f+_[0],e[n+1]=t[n+1]*p+_[1];return e})),t}}return new rr(this.center_)},Sh.prototype.drawSketch_=function(t){if(this.overlayLayer_.getSource().clear(),t){this.square_=this.squareFn_?this.squareFn_(t):t.originalEvent.shiftKey,this.centered_=this.centeredFn_?this.centeredFn_(t):t.originalEvent.metaKey||t.originalEvent.ctrlKey;var e=this.getGeom_();if(e){var i=this.feature_;return this.geometryName_&&i.setGeometryName(this.geometryName_),"Polygon"===e.getType()&&i.getGeometry().setCoordinates(e.getCoordinates()),this.overlayLayer_.getSource().addFeature(i),this.coord_&&this.square_&&(this.canRotate_&&this.centered_&&this.coord_||!this.sides_&&!this.centered_)&&this.overlayLayer_.getSource().addFeature(new ye(new tr([this.center_,this.coord_]))),i}}},Sh.prototype.drawPoint_=function(t,e){e||this.overlayLayer_.getSource().clear(),this.overlayLayer_.getSource().addFeature(new ye(new rr(t)))},Sh.prototype.handleEvent_=function(t){var e,i;switch(this._eventTime=new Date,t.type){case"pointerdown":this.downPx_=t.pixel,this.start_(t);this._longTouch=!1,setTimeout(function(){this._longTouch=new Date-this._eventTime>450,this._longTouch&&this.handleMoveEvent_(t)}.bind(this),500);break;case"pointerup":this.started_&&this.coord_&&(e=this.downPx_[0]-t.pixel[0])*e+(i=this.downPx_[1]-t.pixel[1])*i<=this.squaredClickTolerance_&&("pointermove"==this.lastEvent||"keydown"==this.lastEvent||(e=this.upPx_[0]-t.pixel[0])*e+(i=this.upPx_[1]-t.pixel[1])*i<=this.squaredClickTolerance_?this.end_(t):(this.handleMoveEvent_(t),this.drawPoint_(t.coordinate,!0))),this.upPx_=t.pixel;break;case"pointerdrag":if(this.started_){var n=this.getMap().getPixelFromCoordinate(this.center_);(e=n[0]-t.pixel[0])*e+(i=n[1]-t.pixel[1])*i<=this.squaredClickTolerance_&&this.reset()}return!this._longTouch;case"pointermove":this.started_&&(e=this.downPx_[0]-t.pixel[0])*e+(i=this.downPx_[1]-t.pixel[1])*i>this.squaredClickTolerance_&&(this.handleMoveEvent_(t),this.lastEvent=t.type);break;default:if(this.lastEvent=t.type,this.started_&&"dblclick"===t.type)return!1}return!0},Sh.prototype.finishDrawing=function(){this.started_&&this.coord_&&this.end_({pixel:this.upPx_,coordinate:this.coord_})},Sh.prototype.handleMoveEvent_=function(t){if(this.started_){this.coord_=t.coordinate,this.coordPx_=t.pixel;var e=this.drawSketch_(t);this.dispatchEvent({type:"drawing",feature:e,pixel:t.pixel,startCoordinate:this.center_,coordinate:t.coordinate,square:this.square_,centered:this.centered_})}else this.drawPoint_(t.coordinate)},Sh.prototype.start_=function(t){if(this.started_)this.coord_=t.coordinate;else{this.started_=!0,this.center_=t.coordinate,this.coord_=null;var e=new mr([[t.coordinate,t.coordinate,t.coordinate]]),i=this.feature_=new ye(e);this.drawSketch_(t),this.dispatchEvent({type:"drawstart",feature:i,pixel:t.pixel,coordinate:t.coordinate})}},Sh.prototype.end_=function(t){if(this.coord_=t.coordinate,this.started_=!1,this.coord_&&this.center_[0]!=this.coord_[0]&&this.center_[1]!=this.coord_[1]){var e=this.feature_;this.geometryName_&&e.setGeometryName(this.geometryName_),e.setGeometry(this.getGeom_()),this.source_?this.source_.addFeature(e):this.features_&&this.features_.push(e),this.dispatchEvent({type:"drawend",feature:e,pixel:t.pixel,coordinate:t.coordinate,square:this.square_,centered:this.centered_})}else this.dispatchEvent({type:"drawcancel",feature:null,pixel:t.pixel,coordinate:t.coordinate,square:this.square_,centered:this.centered_});this.center_=this.coord_=null,this.drawSketch_()};var Ch=Sh,bh=function(t){t||(t={});var e=this;this._select=new Qa.a({style:t.style}),this._select.setActive(!1);var i,n=t.geometryFunction;i=n?function(t,i){return i=e._geometryFn(t,i),n(t,i)}:function(t,i){return e._geometryFn(t,i)},t.type="Polygon",t.geometryFunction=i,Ja.call(this,t),t.layers&&("function"==typeof t.layers?this.layers_=t.layers:t.layers.indexOf&&(this.layers_=function(e){return t.layers.indexOf(e)>=0})),this.on("drawstart",this._startDrawing.bind(this)),this.on("drawend",this._finishDrawing.bind(this))};wt(bh,Ja),bh.prototype.setMap=function(t){this.getMap()&&this.getMap().removeInteraction(this._select),t&&t.addInteraction(this._select),Ja.prototype.setMap.call(this,t)},bh.prototype.setActive=function(t){this._select.getFeatures().clear(),Ja.prototype.setActive.call(this,t)},bh.prototype.removeLastPoint=function(){this._feature&&this._feature.getGeometry().getCoordinates()[0].length>2&&Ja.prototype.removeLastPoint.call(this)},bh.prototype.getPolygon=function(){return this._polygon},bh.prototype._startDrawing=function(t){var e=this.getMap(),i=this.layers_;this._feature=t.feature;var n=t.feature.getGeometry().getCoordinates()[0][0],r=e.getFeaturesAtPixel(e.getPixelFromCoordinate(n),{layerFilter:i});if(this._current=null,r)for(var o=0;o<r.length;o++){var s=r[o].getGeometry();if("Polygon"===s.getType()&&s.intersectsCoordinate(n))this._polygonIndex=!1,this._polygon=s,this._current=r[o];else if("MultiPolygon"===s.getType()&&s.intersectsCoordinate(n))for(var a,h=0;a=s.getPolygon(h);h++)if(a.intersectsCoordinate(n)){this._polygonIndex=h,this._polygon=a,this._current=r[o];break}if(this._current)break}this._select.getFeatures().clear(),this._current?this._select.getFeatures().push(this._current):(this.setActive(!1),this.setActive(!0))},bh.prototype._finishDrawing=function(t){t.hole=t.feature,t.feature=this._select.getFeatures().item(0),this.dispatchEvent({type:"modifystart",features:[this._current]});var e=t.hole.getGeometry().getCoordinates()[0];if(e.length>3)if(!1!==this._polygonIndex){for(var i,n=t.feature.getGeometry(),r=new br([]),o=0;i=n.getPolygon(o);o++)o===this._polygonIndex?(i.appendLinearRing(new cr(e)),r.appendPolygon(i)):r.appendPolygon(i);t.feature.setGeometry(r)}else this.getPolygon().appendLinearRing(new cr(e));this.dispatchEvent({type:"modifyend",features:[this._current]}),this._feature=null,this._select.getFeatures().clear()},bh.prototype._geometryFn=function(t,e){var i=t[0].pop();return this.getPolygon()&&!this.getPolygon().intersectsCoordinate(i)||(this.lastOKCoord=[i[0],i[1]]),t[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]),e?e.setCoordinates([t[0].concat([t[0][0]])]):e=new mr(t),e};var Oh=bh,Eh=function(t){(t=t||{}).interactions=t.interactions||{},ue.call(this,{className:(t.className?t.className+" ":"")+"ol-editbar",toggleOne:!0,target:t.target}),this._source=t.source,this._interactions={},this._setSelectInteraction(t),!1!==t.edition&&this._setEditInteraction(t),this._setModifyInteraction(t)};wt(Eh,ue),Eh.prototype.setMap=function(t){this.getMap()&&(this._interactions.Delete&&this.getMap().removeInteraction(this._interactions.Delete),this._interactions.ModifySelect&&this.getMap().removeInteraction(this._interactions.ModifySelect)),ue.prototype.setMap.call(this,t),this.getMap()&&(this._interactions.Delete&&this.getMap().addInteraction(this._interactions.Delete),this._interactions.ModifySelect&&this.getMap().addInteraction(this._interactions.ModifySelect))},Eh.prototype.getInteraction=function(t){return this._interactions[t]},Eh.prototype._getTitle=function(t){return t&&t.title?t.title:t},Eh.prototype._setSelectInteraction=function(t){var e,i=this,n=new ue;if(!1!==t.interactions.Delete){t.interactions.Delete instanceof lh?this._interactions.Delete=t.interactions.Delete:this._interactions.Delete=new lh;var r=this._interactions.Delete;r.setActive(!1),this.getMap()&&this.getMap().addInteraction(r),n.addControl(new nh({className:"ol-delete",title:this._getTitle(t.interactions.Delete)||"Delete",handleClick:function(t){r.delete(e.getInteraction().getFeatures()),console.log("del");var i={type:"select",selected:[],deselected:e.getInteraction().getFeatures().getArray().slice(),mapBrowserEvent:t.mapBrowserEvent};e.getInteraction().getFeatures().clear(),e.getInteraction().dispatchEvent(i)}}))}if(!1!==t.interactions.Info&&n.addControl(new nh({className:"ol-info",title:this._getTitle(t.interactions.Info)||"Show informations",handleClick:function(){i.dispatchEvent({type:"info",features:e.getInteraction().getFeatures()})}})),!1!==t.interactions.Select){t.interactions.Select instanceof Qa.a?this._interactions.Select=t.interactions.Select:this._interactions.Select=new Qa.a({condition:fe.click});var o=this._interactions.Select;e=new oh({className:"ol-selection",title:this._getTitle(t.interactions.Select)||"Select",interaction:o,bar:n.getControls().length?n:void 0,autoActivate:!0,active:!0}),this.addControl(e),o.on("change:active",(function(){o.getFeatures().clear()}))}},Eh.prototype._setEditInteraction=function(t){if(!1!==t.interactions.DrawPoint){t.interactions.DrawPoint instanceof Ja?this._interactions.DrawPoint=t.interactions.DrawPoint:this._interactions.DrawPoint=new Ja({type:"Point",source:this._source});var e=new oh({className:"ol-drawpoint",title:this._getTitle(t.interactions.DrawPoint)||"Point",interaction:this._interactions.DrawPoint});this.addControl(e)}if(!1!==t.interactions.DrawLine){t.interactions.DrawLine instanceof Ja?this._interactions.DrawLine=t.interactions.DrawLine:this._interactions.DrawLine=new Ja({type:"LineString",source:this._source,geometryFunction:function(t,e){return e?e.setCoordinates(t):e=new tr(t),this.nbpts=e.getCoordinates().length,e}});var i=new oh({className:"ol-drawline",title:this._getTitle(t.interactions.DrawLine)||"LineString",interaction:this._interactions.DrawLine,bar:new ue({controls:[new ah({html:this._getTitle(t.interactions.UndoDraw)||"undo",title:this._getTitle(t.interactions.UndoDraw)||"delete last point",handleClick:function(){i.getInteraction().nbpts>1&&i.getInteraction().removeLastPoint()}}),new ah({html:this._getTitle(t.interactions.FinishDraw)||"finish",title:this._getTitle(t.interactions.FinishDraw)||"finish",handleClick:function(){i.getInteraction().nbpts>2&&i.getInteraction().finishDrawing()}})]})});this.addControl(i)}if(!1!==t.interactions.DrawPolygon&&(t.interactions.DrawPolygon instanceof Ja?this._interactions.DrawPolygon=t.interactions.DrawPolygon:this._interactions.DrawPolygon=new Ja({type:"Polygon",source:this._source,geometryFunction:function(t,e){return this.nbpts=t[0].length,e?e.setCoordinates([t[0].concat([t[0][0]])]):e=new mr(t),e}}),this._setDrawPolygon("ol-drawpolygon",this._interactions.DrawPolygon,this._getTitle(t.interactions.DrawPolygon)||"Polygon",t)),!1!==t.interactions.DrawHole&&(t.interactions.DrawHole instanceof Oh?this._interactions.DrawHole=t.interactions.DrawHole:this._interactions.DrawHole=new Oh,this._setDrawPolygon("ol-drawhole",this._interactions.DrawHole,this._getTitle(t.interactions.DrawHole)||"Hole",t)),!1!==t.interactions.DrawRegular){t.interactions.DrawRegular instanceof Ch?this._interactions.DrawRegular=t.interactions.DrawRegular:this._interactions.DrawRegular=new Ch({source:this._source,sides:4});var n=this._interactions.DrawRegular,r=document.createElement("DIV"),o=eh.create("DIV",{parent:r});eh.addListener(o,["click","touchstart"],function(){var t=n.getSides()-1;t<2&&(t=2),n.setSides(t),s.textContent=t>2?t+" pts":"circle"}.bind(this));var s=eh.create("TEXT",{html:"4 pts",parent:r}),a=eh.create("DIV",{parent:r});eh.addListener(a,["click","touchstart"],function(){var t=n.getSides()+1;t<3&&(t=3),n.setSides(t),s.textContent=t+" pts"}.bind(this));var h=new oh({className:"ol-drawregular",title:this._getTitle(t.interactions.DrawRegular)||"Regular",interaction:this._interactions.DrawRegular,bar:new ue({controls:[new ah({html:r})]})});this.addControl(h)}},Eh.prototype._setDrawPolygon=function(t,e,i,n){var r=new oh({className:t,title:i,interaction:e,bar:new ue({controls:[new ah({html:this._getTitle(n.interactions.UndoDraw)||"undo",title:this._getTitle(n.interactions.UndoDraw)||"undo last point",handleClick:function(){r.getInteraction().nbpts>1&&r.getInteraction().removeLastPoint()}}),new ah({html:this._getTitle(n.interactions.FinishDraw)||"finish",title:this._getTitle(n.interactions.FinishDraw)||"finish",handleClick:function(){r.getInteraction().nbpts>3&&r.getInteraction().finishDrawing()}})]})});this.addControl(r)},Eh.prototype._setModifyInteraction=function(t){if(!1!==t.interactions.ModifySelect&&!1!==t.interactions.Select&&(t.interactions.ModifySelect instanceof xh?this._interactions.ModifySelect=t.interactions.ModifySelect:this._interactions.ModifySelect=new xh({features:this.getInteraction("Select").getFeatures()}),this.getMap()&&this.getMap().addInteraction(this._interactions.ModifySelect),this._interactions.ModifySelect.setActive(this._interactions.Select.getActive()),this._interactions.Select.on("change:active",function(){this._interactions.ModifySelect.setActive(this._interactions.Select.getActive())}.bind(this))),!1!==t.interactions.Transform){t.interactions.Transform instanceof mh?this._interactions.Transform=t.interactions.Transform:this._interactions.Transform=new mh({addCondition:fe.shiftKeyOnly});var e=new oh({html:"<i></i>",className:"ol-transform",title:this._getTitle(t.interactions.Transform)||"Transform",interaction:this._interactions.Transform});this.addControl(e)}if(!1!==t.interactions.Split){t.interactions.Split instanceof yh?this._interactions.Split=t.interactions.Split:this._interactions.Split=new yh({sources:this._source});var i=new oh({className:"ol-split",title:this._getTitle(t.interactions.Split)||"Split",interaction:this._interactions.Split});this.addControl(i)}if(!1!==t.interactions.Offset){t.interactions.Offset instanceof _h?this._interactions.Offset=t.interactions.Offset:this._interactions.Offset=new _h({source:this._source});var n=new oh({html:"<i></i>",className:"ol-offset",title:this._getTitle(t.interactions.Offset)||"Offset",interaction:this._interactions.Offset});this.addControl(n)}};var kh,Ph=Eh;kh=Ba.prototype.clear,Ba.prototype.clear=function(t){this.dispatchEvent({type:"clearstart"}),kh.call(this,t),this.dispatchEvent({type:"clearend"})};var Ih=function(t){t||(t={}),kr.call(this,{handleEvent:function(){return!0}}),this._undoStack=[],this._redoStack=[],this._block=0,this._record=!0,this._defs={}};wt(Ih,kr),Ih.prototype.define=function(t,e,i){this._defs["_"+t]={undo:e,redo:i}},Ih.prototype.push=function(t,e){return!!this._defs["_"+t]&&(this._undoStack.push({type:"_"+t,prop:e}),!0)},Ih.prototype.setActive=function(t){kr.prototype.setActive.call(this,t),this._record=t},Ih.prototype.setMap=function(t){kr.prototype.setMap.call(this,t),this._watchSources(),this._watchInteractions()},Ih.prototype._watchSources=function(){var t=this.getMap();(this._sourceListener&&this._sourceListener.forEach((function(t){$t(t)})),this._sourceListener=[],t)&&(function t(e,i){return i||(i=[]),e.forEach((function(e){e instanceof H.a?i.push(e):e.getLayers&&t(e.getLayers(),i)})),i}(t.getLayers()).forEach(function(t){var e=t.getSource();this._sourceListener.push(e.on(["addfeature","removefeature"],this._onAddRemove.bind(this))),this._sourceListener.push(e.on("clearstart",this.blockStart.bind(this))),this._sourceListener.push(e.on("clearend",this.blockEnd.bind(this)))}.bind(this)),this._sourceListener.push(t.getLayers().on(["add","remove"],this._watchSources.bind(this))))},Ih.prototype._watchInteractions=function(){var t=this.getMap();this._interactionListener&&this._interactionListener.forEach((function(t){$t(t)})),this._interactionListener=[],t&&(t.getInteractions().forEach(function(t){this._interactionListener.push(t.on(["setattributestart","modifystart","rotatestart","translatestart","scalestart","deletestart","deleteend","beforesplit","aftersplit"],this._onInteraction.bind(this)))}.bind(this)),this._interactionListener.push(t.getInteractions().on(["add","remove"],this._watchInteractions.bind(this))))},Ih.prototype._onAddRemove=function(t){this._record&&(this._undoStack.push({type:t.type,source:t.target,feature:t.feature}),this._redoStack=[])},Ih.prototype._onInteraction=function(t){var e=this._onInteraction[t.type];e&&e.call(this,t)},Ih.prototype._onInteraction.setattributestart=function(t){this.blockStart();var e=Object.assign({},t.properties);t.features.forEach(function(t){var i={};for(var n in e)i[n]=t.get(n);this._undoStack.push({type:"changeattribute",feature:t,newProperties:e,oldProperties:i})}.bind(this)),this.blockEnd()},Ih.prototype._onInteraction.rotatestart=Ih.prototype._onInteraction.translatestart=Ih.prototype._onInteraction.scalestart=Ih.prototype._onInteraction.modifystart=function(t){this.blockStart(),t.features.forEach(function(t){this._undoStack.push({type:"changefeature",feature:t,oldFeature:t.clone()})}.bind(this)),this.blockEnd()},Ih.prototype.blockStart=function(){this._undoStack.push({type:"blockstart"}),this._redoStack=[]},Ih.prototype._onInteraction.beforesplit=Ih.prototype._onInteraction.deletestart=Ih.prototype.blockStart,Ih.prototype.blockEnd=function(){this._undoStack.push({type:"blockend"})},Ih.prototype._onInteraction.aftersplit=Ih.prototype._onInteraction.deleteend=Ih.prototype.blockEnd,Ih.prototype._handleDo=function(t,e){if(this.getActive()){switch(this._record=!1,t.type){case"addfeature":e?t.source.removeFeature(t.feature):t.source.addFeature(t.feature);break;case"removefeature":e?t.source.addFeature(t.feature):t.source.removeFeature(t.feature);break;case"changefeature":var i=t.feature.getGeometry();t.feature.setGeometry(t.oldFeature.getGeometry()),t.oldFeature.setGeometry(i);break;case"changeattribute":var n=t.newProperties,r=t.oldProperties;for(var o in r)void 0===r?t.feature.unset(o):t.feature.set(o,r[o]);t.oldProperties=n,t.newProperties=r;break;case"blockstart":this._block+=e?-1:1;break;case"blockend":this._block+=e?1:-1;break;default:this._defs[t.type]?e?this._defs[t.type].undo(t.prop):this._defs[t.type].redo(t.prop):console.warn('[UndoRedoInteraction]: "'+t.type.substr(1)+'" is not defined.')}this._block<0&&(this._block=0),this._block&&(e?this.undo():this.redo()),this._record=!0,this.dispatchEvent({type:e?"undo":"redo",action:t})}},Ih.prototype.undo=function(){var t=this._undoStack.pop();t&&(this._redoStack.push(t),this._handleDo(t,!0))},Ih.prototype.redo=function(){var t=this._redoStack.pop();t&&(this._undoStack.push(t),this._handleDo(t,!1))},Ih.prototype.clear=function(){this._undoStack=[],this._redoStack=[]},Ih.prototype.hasUndo=function(){return this._undoStack.length},Ih.prototype.hasRedo=function(){return this._redoStack.length};var Th=Ih;function Dh(t){return(Dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lh(t,e){return!e||"object"!==Dh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fh(t,e,i){return(Fh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rh(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function Rh(t){return(Rh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ah(t,e){return(Ah=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}ue.prototype.destroy=function(){function t(t){if(t._interactions)for(var e=0,i=Object.keys(t._interactions);e<i.length;e++){var n=i[e];t.getMap().removeInteraction(t._interactions[n])}}if(this.getMap()){t(this);var e=!0,i=!1,n=void 0;try{for(var r,o=this.controls_[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;if(s instanceof ue)s.destroy();else{s.getSubBar&&s.getSubBar()&&s.getSubBar().destroy(),t(s),this.getMap().removeControl(s);var a=s.getButtonElement();a.parentNode.removeChild(a)}}}catch(t){i=!0,n=t}finally{try{e||null==o.return||o.return()}finally{if(i)throw n}}this.element.parentNode.removeChild(this.element),this.getMap().removeControl(this),this.controls_=[]}},Th.prototype.getFeaturesChanged=function(){for(var t={},e=0,i=0,n=this._undoStack.length;i<n;i++)if(this._undoStack[i].feature){var r="f"+this._undoStack[i].feature.ol_uid;t[r]?"addfeature"===t[r].type?"removefeature"===this._undoStack[i].type?delete t[r]:t[r].feature=this._undoStack[i].feature:(t[r].feature=this._undoStack[i].feature,t[r].type=this._undoStack[i].type):(e++,t[r]={feature:this._undoStack[i].feature,type:this._undoStack[i].type})}return e?t:void 0},Th.prototype.undoAll=function(){var t=this._undoStack.pop();t&&(this._handleDo(t,!0),this.undoAll())};var jh=function(t){function e(t){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t||{};if(!n.layer||!n.layer.editable)return Lh(i,void 0);var r={ALL:{Select:!0,Delete:!0,Info:!0,DrawPoint:!0,DrawLine:!0,DrawPolygon:!0,DrawHole:!0,DrawRegular:!0,Transform:!0,Split:!0,Offset:!0},Point:{Select:!0,Delete:!0,Info:!1,DrawPoint:!0,DrawLine:!1,DrawPolygon:!1,DrawHole:!1,DrawRegular:!1,Transform:!1,Split:!1,Offset:!1},LineString:{Select:!0,Delete:!0,Info:!1,DrawPoint:!1,DrawLine:!0,DrawPolygon:!1,DrawHole:!1,DrawRegular:!1,Transform:!0,Split:!0,Offset:!0},Polygon:{Select:!0,Delete:!0,Info:!1,DrawPoint:!1,DrawLine:!1,DrawPolygon:!0,DrawHole:!0,DrawRegular:!0,Transform:!0,Split:!1,Offset:!1}};return(i=Lh(this,Rh(e).call(this,n))).layer=n.layer,i.map=n.map,r[i.layer.geometryType].Select=new Qa.a({condition:fe.click,style:C.styleEdit(),layers:function(t){return t===i.layer}}),i.olControlEditbar=new Ph({source:i.layer.getSource(),interactions:r[i.layer.geometryType]||r.ALL}),i.addControl(i.olControlEditbar),i.undoInteraction=new Th,i.map.addInteraction(i.undoInteraction),i.undoInteraction.on("undo",(function(t){if("addfeature"===t.action.type){i.olControlEditbar.getInteraction("Select").getFeatures().clear();var e=i.olControlEditbar.getInteraction("Transform");e&&e.select()}})),i.barUndoRedo=new ue({group:!0,controls:[new nh({html:"<b>&#x21b6</b>",title:"undo...",handleClick:function(){i.undoInteraction.undo()}}),new nh({html:"<b>&#x21b7</b>",title:"redo...",handleClick:function(){i.undoInteraction.redo()}})]}),i.addControl(i.barUndoRedo),i.setMap(i.map),Lh(i)}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ah(t,e)}(e,t),i=e,(n=[{key:"getLayer",value:function(){return this.layer}},{key:"getFeaturesChanged",value:function(){if(this.undoInteraction)return this.undoInteraction.getFeaturesChanged()}},{key:"saveChanges",value:function(){var t=this.getFeaturesChanged();t&&this.layer&&this.layer.save&&(confirm("Salvar Capa? ")?this.layer.save(t):this.undoEdited())}},{key:"undoEdited",value:function(){this.undoInteraction.undoAll()}},{key:"destroy",value:function(){this.map&&(this.map.removeInteraction(this.undoInteraction),this.map.removeControl(this.barUndoRedo),Fh(Rh(e.prototype),"destroy",this).call(this),this.undoInteraction=void 0,this.barUndoRedo=void 0,this.map.editionBar=void 0,this.map=void 0)}}])&&Mh(i.prototype,n),r&&Mh(i,r),e}(ue),Gh=i(10),Nh=i(11),Wh=i.n(Nh),Xh=i(12),Bh=i.n(Xh),Yh=i(13);function qh(t){return(qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zh(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Vh(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Kh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Uh(t,e){return!e||"object"!==qh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hh(t){return(Hh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zh(t,e){return(Zh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Qa.a.prototype.giveSelectedStyle_=function(t){var e=Object(Gh.getUid)(t);this.featureStyleAssociation_[e]=t.getStyle();var i=this.featureLayerAssociation_[e].getStyle()(t),n=i.getImage&&i.getImage();n&&this.style_.getImage().setRadius(n.getRadius());var r=Array.isArray(i)?i.slice():[i];r.push(this.style_),t.setStyle(r)};var Jh=function(t){function e(t){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t||{},r=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?zh(Object(i),!0).forEach((function(e){Vh(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):zh(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},n);return delete r.layers,delete r.view,n.view&&(n.view.projectionCenter&&(n.view.center=Object(Yh.transform)(n.view.center,n.view.projectionCenter,"EPSG:3857")),r.view=new Bh.a(n.view)),r.layers=L.json2Layers(n.layers),(i=Uh(this,Hh(e).call(this,r))).workLayer=void 0,i.editionBar=void 0,i.interactionMap={},i}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zh(t,e)}(e,t),i=e,(n=[{key:"setWorkLayer",value:function(t){if(this.workLayer&&delete this.workLayer.workLayer,t&&this.workLayer!==t)return this.workLayer=t,this.workLayer.workLayer=!0,this.workLayer;this.workLayer=void 0}},{key:"activateInteraction",value:function(t){this._eraseInteractionMap("highlight"),"highlight"===t&&this._createInteractionHighlight()}},{key:"activateBar",value:function(t,e,i){"editionBar"===t&&(e?(this._eraseInteractionMap("highlight"),this.editionBar&&i!==this.editionBar.getLayer()&&(this.editionBar.saveChanges(),this.editionBar.destroy(),this.editionBar=void 0),this.editionBar||i.editable&&(this.editionBar=new jh({map:this,layer:i}))):(this.editionBar&&(this.editionBar.saveChanges(),this.editionBar.destroy(),this.editionBar=void 0),this._createInteractionHighlight()))}},{key:"isEditionBarActivated",value:function(){return!!this.editionBar}},{key:"_eraseInteractionMap",value:function(t){this.interactionMap[t]&&(this.interactionMap[t].getFeatures&&this.interactionMap[t].getFeatures().clear(),this.removeInteraction(this.interactionMap[t])),this.interactionMap[t]=void 0}},{key:"_createInteractionHighlight",value:function(){var t=this;this.interactionMap.highlight||(this.interactionMap.highlight=new Qa.a({condition:fe.pointerMove,style:C.styleSelect(),layers:function(e){return t.workLayer?e===t.workLayer?(t._layerPaint=e,!0):(t._layerPaint=!1,!1):(t._layerPaint=e,!0)}}),this.addInteraction(this.interactionMap.highlight))}}])&&Kh(i.prototype,n),r&&Kh(i,r),e}(Wh.a);window.ol&&!ol.tsig&&(ol.tsig={layer:r,control:o,map:s,utils:n})}]).default}));